<!doctype html><html lang=zh-tw dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[AI] 提升模型的表現 | Rain Hu's Workspace</title><meta name=keywords content="AI"><meta name=description content="How to enhance the performance of the model"><meta name=author content="Rain Hu"><link rel=canonical href=https://intervalrain.github.io/><meta name=google-site-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.0cefe5a1d95e3d0f0cce057d37c60cd238d1a4af825090f831a18f21671f621d.css integrity="sha256-DO/lodlePQ8MzgV9N8YM0jjRpK+CUJD4MaGPIWcfYh0=" rel="preload stylesheet" as=style><link rel=icon href=https://intervalrain.github.io/images/rain.png><link rel=icon type=image/png sizes=16x16 href=https://intervalrain.github.io/images/rain.png><link rel=icon type=image/png sizes=32x32 href=https://intervalrain.github.io/images/rain.png><link rel=apple-touch-icon href=https://intervalrain.github.io/images/rain.png><link rel=mask-icon href=https://intervalrain.github.io/images/rain.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh-tw href=https://intervalrain.github.io/ai/5_3/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css integrity=sha384-zTROYFVGOfTw7JV7KUu8udsvW2fx4lWOsCEDqhBreBwlHI4ioVRtmIvEThzJHGET crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.js integrity=sha384-GxNFqL3r9uRJQhR+47eDxuPoNE7yLftQM8LcxzgS4HT73tp970WS/wV5p8UzCOmb crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous onload=renderMathInElement(document.body)></script><script src=https://utteranc.es/client.js repo=intervalrain.github.io issue-term=pathname label=Comment theme=github-light crossorigin=anonymous async></script><meta property="og:url" content="https://intervalrain.github.io/ai/5_3/"><meta property="og:site_name" content="Rain Hu's Workspace"><meta property="og:title" content="[AI] 提升模型的表現"><meta property="og:description" content="How to enhance the performance of the model"><meta property="og:locale" content="zh-tw"><meta property="og:type" content="article"><meta property="article:section" content="ai"><meta property="article:published_time" content="2025-01-12T17:54:27+08:00"><meta property="article:modified_time" content="2025-01-12T17:54:27+08:00"><meta property="article:tag" content="AI"><meta name=twitter:card content="summary"><meta name=twitter:title content="[AI] 提升模型的表現"><meta name=twitter:description content="How to enhance the performance of the model"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"[AI] 提升模型的表現","item":"https://intervalrain.github.io/ai/5_3/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[AI] 提升模型的表現","name":"[AI] 提升模型的表現","description":"How to enhance the performance of the model","keywords":["AI"],"articleBody":" 要達到完美擬合(perfect fit)，勢必要先經歷過度擬合(overfitting)，否則我們無法預先知道邊界在哪裡。 因此我們要處理任何機器學習問題的初始目標，便是訓練出一個能展現基本普適化能力，並且會發生 overfitting 的模型，接著才可以專注在解決 overfitting 並提升模型的普適化能力。 我們會遇到三個 status: 訓練沒有成效，損失值降不下來。 訓練可行，但無法展現普適化，無法超越基準線。 訓練可行且表現也超越基準線，但無法達到 overfitting。 調整梯度下降的關鍵參數 當訓練沒有成效，代表損失無法下降。 一般而言，就算資料是隨機的，模型有辦法擬合，所以損失無法下降通常可以斷定是 gradient descent 的參數設置需要調整，包含: 優化器(optimizer) 初始權重(initial weight) 學習率(learning rate) 批次量(batch size) 從上圖可見，當學習率太大時，每一次的跨幅過大，使 loss 無法降低；當學習率太小時，每次跨幅太小，訓練的效率不好，當學習率適當時，可以達到最好的成效。 學習率比較的程式碼 import numpy as np import matplotlib.pyplot as plt def objective_function(x, y): return 0.7*x**2 + 1.3*y**2 def gradient(x, y): return np.array([1.4*x, 2.6*y]) def gradient_descent(learning_rate, start_point, n_iterations=50): path = [start_point] point = np.array(start_point) for _ in range(n_iterations): grad = gradient(point[0], point[1]) point = point - learning_rate * grad path.append(point.copy()) if np.linalg.norm(grad) \u003c 1e-6: break return np.array(path) x = np.linspace(-10, 10, 100) # 擴大範圍到 ±10 y = np.linspace(-10, 10, 100) X, Y = np.meshgrid(x, y) Z = objective_function(X, Y) plt.figure(figsize=(15, 6)) learning_rates = [0.77, 0.1, 0.01] titles = ['Learning Rate = 0.77', 'Learning Rate = 0.1', 'Learning Rate = 0.01'] start_point = np.array([4.0, 4.0]) for i, (lr, title) in enumerate(zip(learning_rates, titles)): plt.subplot(1, 3, i+1) plt.contour(X, Y, Z, levels=20, cmap='viridis') path = gradient_descent(lr, start_point) plt.plot(path[:, 0], path[:, 1], 'r.-', linewidth=1, markersize=3, label=f'Gradient Descent Path\\nIterations: {len(path)}') plt.plot(path[0, 0], path[0, 1], 'g*', markersize=10, label='Start') plt.plot(path[-1, 0], path[-1, 1], 'r*', markersize=10, label='End') plt.title(title) plt.xlabel('x') plt.ylabel('y') plt.legend() plt.colorbar(label='Function Value') plt.grid(True) plt.tight_layout() plt.show() 使用不同的架構 選擇合適的模型架構處理不同類型的問題 DNN CNN(Convolutional Neural Networks) RNN(Recurrent Neural Networks) Transformer Autoencoders GAN(Generative Adversarial Networks) GNN(Graph Neural Networks) … 提升模型容量(capacity) 如果損失值的確有降低，代表模型的確有在擬合資料，但始終無終達到 overfitting，那可能是模型的 表徵能力(representational power) 不足。 這時可能需要更大的模型，以容納更多的資訊， 可以透過加深、加寬 layer 來提升模型的容量。 從上例，用一個 sin 函數做為 target function，然後用不同 degree 的方程式來進行擬合。當 degree = 1 時，這個線性模型不管怎麼樣都無法 fit data，說明它的模型沒有足夠的表徵能力，而當 degree = 15 時，模型過份的去 fit data，當今天有新的 data 加入時，模型就會無法很好的預測，這代表模型缺乏普適力。 用 n 次方程式來說明模型容量的差異程式碼 import numpy as np import matplotlib.pyplot as plt from sklearn.preprocessing import PolynomialFeatures from sklearn.linear_model import LinearRegression # 生成數據 np.random.seed(42) X = np.linspace(0, 1, 20).reshape(-1, 1) y_true = np.sin(2 * np.pi * X) y = y_true + np.random.normal(0, 0.1, X.shape) # 訓練不同容量的模型 degrees = [1, 3, 15] X_test = np.linspace(0, 1, 100).reshape(-1, 1) plt.figure(figsize=(15, 5)) titles = ['Underfitting\\n(Degree=1)', 'Good Fit\\n(Degree=3)', 'Overfitting\\n(Degree=15)'] for i, degree in enumerate(degrees): plt.subplot(1, 3, i+1) # 轉換特徵 poly = PolynomialFeatures(degree) X_poly = poly.fit_transform(X) X_test_poly = poly.transform(X_test) # 訓練模型 model = LinearRegression() model.fit(X_poly, y) y_pred = model.predict(X_test_poly) # 繪圖 plt.scatter(X, y, color='blue', alpha=0.5, label='Training Data') plt.plot(X_test, y_pred, 'r-', label=f'Model') plt.plot(X_test, np.sin(2 * np.pi * X_test), 'g--', label='True Function') plt.title(titles[i]) plt.xlabel('x') plt.ylabel('y') plt.legend() plt.grid(True) plt.tight_layout() plt.show() ","wordCount":"353","inLanguage":"zh-tw","datePublished":"2025-01-12T17:54:27+08:00","dateModified":"2025-01-12T17:54:27+08:00","author":{"@type":"Person","name":"Rain Hu"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://intervalrain.github.io/ai/5_3/"},"publisher":{"@type":"Organization","name":"Rain Hu's Workspace","logo":{"@type":"ImageObject","url":"https://intervalrain.github.io/images/rain.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://intervalrain.github.io/ accesskey=h title="Rain Hu's Workspace (Alt + H)"><img src=https://intervalrain.github.io/images/rain.png alt aria-label=logo height=35>Rain Hu's Workspace</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://intervalrain.github.io/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://intervalrain.github.io/aboutme title="About me"><span>About me</span></a></li><li><a href=https://intervalrain.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://intervalrain.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://intervalrain.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://intervalrain.github.io/csharp/csharp title=C#><span>C#</span></a></li><li><a href=https://intervalrain.github.io/csindex title=CS><span>CS</span></a></li><li><a href=https://intervalrain.github.io/leetcode title=LeetCode><span>LeetCode</span></a></li><li><a href=https://intervalrain.github.io/ai title=AI><span>AI</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://intervalrain.github.io/>首頁</a></div><h1 class="post-title entry-hint-parent">[AI] 提升模型的表現</h1><div class=post-description>How to enhance the performance of the model</div><div class=post-meta><span title='2025-01-12 17:54:27 +0800 +0800'>January 12, 2025</span>&nbsp;·&nbsp;2 分鐘&nbsp;·&nbsp;Rain Hu&nbsp;|&nbsp;<a href=https://github.com/intervalrain/intervalrain.github.io/tree/main/content//AI/5_3.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目錄</span></summary><div class=inner><ul><li><a href=#%e8%aa%bf%e6%95%b4%e6%a2%af%e5%ba%a6%e4%b8%8b%e9%99%8d%e7%9a%84%e9%97%9c%e9%8d%b5%e5%8f%83%e6%95%b8 aria-label=調整梯度下降的關鍵參數>調整梯度下降的關鍵參數</a></li><li><a href=#%e4%bd%bf%e7%94%a8%e4%b8%8d%e5%90%8c%e7%9a%84%e6%9e%b6%e6%a7%8b aria-label=使用不同的架構>使用不同的架構</a></li><li><a href=#%e6%8f%90%e5%8d%87%e6%a8%a1%e5%9e%8b%e5%ae%b9%e9%87%8fcapacity aria-label=提升模型容量(capacity)>提升模型容量(capacity)</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><ul><li>要達到完美擬合(perfect fit)，勢必要先經歷過度擬合(overfitting)，否則我們無法預先知道邊界在哪裡。
<img alt=perfect_fit loading=lazy src=/ai/AI/5_3/perfect_fit.png></li><li>因此我們要處理任何機器學習問題的初始目標，便是訓練出一個能展現基本普適化能力，並且會發生 overfitting 的模型，接著才可以專注在解決 overfitting 並提升模型的普適化能力。</li><li>我們會遇到三個 status:<ol><li>訓練沒有成效，損失值降不下來。</li><li>訓練可行，但無法展現普適化，無法超越基準線。</li><li>訓練可行且表現也超越基準線，但無法達到 overfitting。</li></ol></li></ul><h2 id=調整梯度下降的關鍵參數>調整梯度下降的關鍵參數<a hidden class=anchor aria-hidden=true href=#調整梯度下降的關鍵參數>#</a></h2><ul><li>當訓練沒有成效，代表損失無法下降。</li><li>一般而言，就算資料是隨機的，模型有辦法擬合，所以損失無法下降通常可以斷定是 gradient descent 的參數設置需要調整，包含:<ol><li>優化器(optimizer)</li><li>初始權重(initial weight)</li><li>學習率(learning rate)</li><li>批次量(batch size)</li></ol></li></ul><p><img alt=learning_rate_comparison loading=lazy src=/ai/AI/5_3/learning_rate.png></p><ul><li>從上圖可見，當學習率太大時，每一次的跨幅過大，使 loss 無法降低；當學習率太小時，每次跨幅太小，訓練的效率不好，當學習率適當時，可以達到最好的成效。</li></ul><details><summary>學習率比較的程式碼</summary><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>objective_function</span>(x, y):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>0.7</span><span style=color:#f92672>*</span>x<span style=color:#f92672>**</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>1.3</span><span style=color:#f92672>*</span>y<span style=color:#f92672>**</span><span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>gradient</span>(x, y):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> np<span style=color:#f92672>.</span>array([<span style=color:#ae81ff>1.4</span><span style=color:#f92672>*</span>x, <span style=color:#ae81ff>2.6</span><span style=color:#f92672>*</span>y])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>gradient_descent</span>(learning_rate, start_point, n_iterations<span style=color:#f92672>=</span><span style=color:#ae81ff>50</span>):
</span></span><span style=display:flex><span>    path <span style=color:#f92672>=</span> [start_point]
</span></span><span style=display:flex><span>    point <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array(start_point)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> _ <span style=color:#f92672>in</span> range(n_iterations):
</span></span><span style=display:flex><span>        grad <span style=color:#f92672>=</span> gradient(point[<span style=color:#ae81ff>0</span>], point[<span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>        point <span style=color:#f92672>=</span> point <span style=color:#f92672>-</span> learning_rate <span style=color:#f92672>*</span> grad
</span></span><span style=display:flex><span>        path<span style=color:#f92672>.</span>append(point<span style=color:#f92672>.</span>copy())
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> np<span style=color:#f92672>.</span>linalg<span style=color:#f92672>.</span>norm(grad) <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>1e-6</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> np<span style=color:#f92672>.</span>array(path)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>x <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>linspace(<span style=color:#f92672>-</span><span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>100</span>)  <span style=color:#75715e># 擴大範圍到 ±10</span>
</span></span><span style=display:flex><span>y <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>linspace(<span style=color:#f92672>-</span><span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>10</span>, <span style=color:#ae81ff>100</span>)
</span></span><span style=display:flex><span>X, Y <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>meshgrid(x, y)
</span></span><span style=display:flex><span>Z <span style=color:#f92672>=</span> objective_function(X, Y)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>15</span>, <span style=color:#ae81ff>6</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>learning_rates <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0.77</span>, <span style=color:#ae81ff>0.1</span>, <span style=color:#ae81ff>0.01</span>]
</span></span><span style=display:flex><span>titles <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;Learning Rate = 0.77&#39;</span>, <span style=color:#e6db74>&#39;Learning Rate = 0.1&#39;</span>, <span style=color:#e6db74>&#39;Learning Rate = 0.01&#39;</span>]
</span></span><span style=display:flex><span>start_point <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>array([<span style=color:#ae81ff>4.0</span>, <span style=color:#ae81ff>4.0</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i, (lr, title) <span style=color:#f92672>in</span> enumerate(zip(learning_rates, titles)):
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>subplot(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>, i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>contour(X, Y, Z, levels<span style=color:#f92672>=</span><span style=color:#ae81ff>20</span>, cmap<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;viridis&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    path <span style=color:#f92672>=</span> gradient_descent(lr, start_point)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>plot(path[:, <span style=color:#ae81ff>0</span>], path[:, <span style=color:#ae81ff>1</span>], <span style=color:#e6db74>&#39;r.-&#39;</span>, linewidth<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>, markersize<span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>, 
</span></span><span style=display:flex><span>             label<span style=color:#f92672>=</span><span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Gradient Descent Path</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>Iterations: </span><span style=color:#e6db74>{</span>len(path)<span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>plot(path[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0</span>], path[<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>], <span style=color:#e6db74>&#39;g*&#39;</span>, markersize<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>, label<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Start&#39;</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>plot(path[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>0</span>], path[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>], <span style=color:#e6db74>&#39;r*&#39;</span>, markersize<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>, label<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;End&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>title(title)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>xlabel(<span style=color:#e6db74>&#39;x&#39;</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>ylabel(<span style=color:#e6db74>&#39;y&#39;</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>legend()
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>colorbar(label<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Function Value&#39;</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>grid(<span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>tight_layout()
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div></details><h2 id=使用不同的架構>使用不同的架構<a hidden class=anchor aria-hidden=true href=#使用不同的架構>#</a></h2><ul><li>選擇合適的模型架構處理不同類型的問題</li><li>DNN</li><li>CNN(Convolutional Neural Networks)</li><li>RNN(Recurrent Neural Networks)</li><li>Transformer</li><li>Autoencoders</li><li>GAN(Generative Adversarial Networks)</li><li>GNN(Graph Neural Networks)</li><li>&mldr;</li></ul><h2 id=提升模型容量capacity>提升模型容量(capacity)<a hidden class=anchor aria-hidden=true href=#提升模型容量capacity>#</a></h2><ul><li>如果損失值的確有降低，代表模型的確有在擬合資料，但始終無終達到 overfitting，那可能是模型的 <strong>表徵能力(representational power)</strong> 不足。</li><li>這時可能需要更大的模型，以容納更多的資訊，</li><li>可以透過加深、加寬 layer 來提升模型的容量。</li></ul><p><img alt=capacity_comparison loading=lazy src=/ai/AI/5_3/capacity_comparison.png></p><ul><li>從上例，用一個 sin 函數做為 target function，然後用不同 degree 的方程式來進行擬合。當 degree = 1 時，這個線性模型不管怎麼樣都無法 fit data，說明它的模型沒有足夠的表徵能力，而當 degree = 15 時，模型過份的去 fit data，當今天有新的 data 加入時，模型就會無法很好的預測，這代表模型缺乏普適力。<details><summary>用 n 次方程式來說明模型容量的差異程式碼</summary></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> numpy <span style=color:#66d9ef>as</span> np
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> matplotlib.pyplot <span style=color:#66d9ef>as</span> plt
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.preprocessing <span style=color:#f92672>import</span> PolynomialFeatures
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> sklearn.linear_model <span style=color:#f92672>import</span> LinearRegression
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 生成數據</span>
</span></span><span style=display:flex><span>np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>seed(<span style=color:#ae81ff>42</span>)
</span></span><span style=display:flex><span>X <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>linspace(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>20</span>)<span style=color:#f92672>.</span>reshape(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>y_true <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>sin(<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> np<span style=color:#f92672>.</span>pi <span style=color:#f92672>*</span> X)
</span></span><span style=display:flex><span>y <span style=color:#f92672>=</span> y_true <span style=color:#f92672>+</span> np<span style=color:#f92672>.</span>random<span style=color:#f92672>.</span>normal(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>0.1</span>, X<span style=color:#f92672>.</span>shape)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 訓練不同容量的模型</span>
</span></span><span style=display:flex><span>degrees <span style=color:#f92672>=</span> [<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>, <span style=color:#ae81ff>15</span>]
</span></span><span style=display:flex><span>X_test <span style=color:#f92672>=</span> np<span style=color:#f92672>.</span>linspace(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>100</span>)<span style=color:#f92672>.</span>reshape(<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>figure(figsize<span style=color:#f92672>=</span>(<span style=color:#ae81ff>15</span>, <span style=color:#ae81ff>5</span>))
</span></span><span style=display:flex><span>titles <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#39;Underfitting</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>(Degree=1)&#39;</span>, <span style=color:#e6db74>&#39;Good Fit</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>(Degree=3)&#39;</span>, <span style=color:#e6db74>&#39;Overfitting</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>(Degree=15)&#39;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i, degree <span style=color:#f92672>in</span> enumerate(degrees):
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>subplot(<span style=color:#ae81ff>1</span>, <span style=color:#ae81ff>3</span>, i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 轉換特徵</span>
</span></span><span style=display:flex><span>    poly <span style=color:#f92672>=</span> PolynomialFeatures(degree)
</span></span><span style=display:flex><span>    X_poly <span style=color:#f92672>=</span> poly<span style=color:#f92672>.</span>fit_transform(X)
</span></span><span style=display:flex><span>    X_test_poly <span style=color:#f92672>=</span> poly<span style=color:#f92672>.</span>transform(X_test)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 訓練模型</span>
</span></span><span style=display:flex><span>    model <span style=color:#f92672>=</span> LinearRegression()
</span></span><span style=display:flex><span>    model<span style=color:#f92672>.</span>fit(X_poly, y)
</span></span><span style=display:flex><span>    y_pred <span style=color:#f92672>=</span> model<span style=color:#f92672>.</span>predict(X_test_poly)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e># 繪圖</span>
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>scatter(X, y, color<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;blue&#39;</span>, alpha<span style=color:#f92672>=</span><span style=color:#ae81ff>0.5</span>, label<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;Training Data&#39;</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>plot(X_test, y_pred, <span style=color:#e6db74>&#39;r-&#39;</span>, label<span style=color:#f92672>=</span><span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;Model&#39;</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>plot(X_test, np<span style=color:#f92672>.</span>sin(<span style=color:#ae81ff>2</span> <span style=color:#f92672>*</span> np<span style=color:#f92672>.</span>pi <span style=color:#f92672>*</span> X_test), <span style=color:#e6db74>&#39;g--&#39;</span>, label<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;True Function&#39;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>title(titles[i])
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>xlabel(<span style=color:#e6db74>&#39;x&#39;</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>ylabel(<span style=color:#e6db74>&#39;y&#39;</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>legend()
</span></span><span style=display:flex><span>    plt<span style=color:#f92672>.</span>grid(<span style=color:#66d9ef>True</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>tight_layout()
</span></span><span style=display:flex><span>plt<span style=color:#f92672>.</span>show()
</span></span></code></pre></div></details></div><footer class=post-footer><ul class=post-tags><li><a href=https://intervalrain.github.io/tags/ai/>AI</a></li></ul><nav class=paginav><a class=prev href=https://intervalrain.github.io/ai/5_2/><span class=title>« 上一頁</span><br><span>[AI] 評估模型</span>
</a><a class=next href=https://intervalrain.github.io/ai/5_4/><span class=title>下一頁 »</span><br><span>[AI] 提高普適化能力</span></a></nav></footer><script src=https://utteranc.es/client.js repo=Reid00/hugo-blog-talks issue-term=pathname label=Comment theme=github-light crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2025 <a href=https://intervalrain.github.io/>Rain Hu's Workspace</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="複製";function s(){t.innerHTML="已複製！",setTimeout(()=>{t.innerHTML="複製"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>