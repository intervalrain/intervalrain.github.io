<!doctype html><html lang=zh-tw dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[IT] SQL | Rain Hu's Workspace</title><meta name=keywords content="SQL,IT"><meta name=description content="Base command of SQL"><meta name=author content="Rain Hu"><link rel=canonical href=https://intervalrain.github.io/><meta name=google-site-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.4c6c0beaf1dfe52cd0f712a5896ac127e66fd064cfc598e04750f496d470699e.css integrity="sha256-TGwL6vHf5SzQ9xKliWrBJ+Zv0GTPxZjgR1D0ltRwaZ4=" rel="preload stylesheet" as=style><link rel=icon href=https://intervalrain.github.io/images/rain.png><link rel=icon type=image/png sizes=16x16 href=https://intervalrain.github.io/images/rain.png><link rel=icon type=image/png sizes=32x32 href=https://intervalrain.github.io/images/rain.png><link rel=apple-touch-icon href=https://intervalrain.github.io/images/rain.png><link rel=mask-icon href=https://intervalrain.github.io/images/rain.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh-tw href=https://intervalrain.github.io/it/sql/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css integrity=sha384-zTROYFVGOfTw7JV7KUu8udsvW2fx4lWOsCEDqhBreBwlHI4ioVRtmIvEThzJHGET crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.js integrity=sha384-GxNFqL3r9uRJQhR+47eDxuPoNE7yLftQM8LcxzgS4HT73tp970WS/wV5p8UzCOmb crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous onload=renderMathInElement(document.body)></script><script src=https://utteranc.es/client.js repo=intervalrain.github.io issue-term=pathname label=Comment theme=github-light crossorigin=anonymous async></script><meta property="og:url" content="https://intervalrain.github.io/it/sql/"><meta property="og:site_name" content="Rain Hu's Workspace"><meta property="og:title" content="[IT] SQL"><meta property="og:description" content="Base command of SQL"><meta property="og:locale" content="zh-tw"><meta property="og:type" content="article"><meta property="article:section" content="it"><meta property="article:published_time" content="2022-09-01T13:28:14+08:00"><meta property="article:modified_time" content="2022-09-01T13:28:14+08:00"><meta property="article:tag" content="SQL"><meta property="article:tag" content="IT"><meta name=twitter:card content="summary"><meta name=twitter:title content="[IT] SQL"><meta name=twitter:description content="Base command of SQL"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"ITs","item":"https://intervalrain.github.io/it/"},{"@type":"ListItem","position":2,"name":"[IT] SQL","item":"https://intervalrain.github.io/it/sql/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[IT] SQL","name":"[IT] SQL","description":"Base command of SQL","keywords":["SQL","IT"],"articleBody":"Introduction What is SQL? SQL stands for Structured Query Language SQL lets you access and manipualate databases SQL becaome a standard of the American National Standards Institute (ANSI) in 1986, and of the International Organization for Standardization (ISO) in 1987 RDBMS RDBMS stands for Relational Database Management System. RDBMS is the basis for SQL, and for all modern database systems such as MS SQL Server, IBM DB2, Oracle, MySQL, and Microsoft Access. The data in RDBMS is stored in database objects called tables. A table is a collection of related data entries and it consists of columns and rows. Syntax SELECT * FROM Customers; SQL keywords are NOT case sensitive. Some database systems requires a semicolon at the end of each SQL statement. Semicolon is the standard way to separate each SQL statement in database systems that allow more than one SQL statement to be executed in the same call to the server. Most Important SQL Commands SELECT - extracts data from a database UPDATE - updates data in a database DELETE - deletes data from a database INSERT INTO - inserts new data into a database CREATE DATABASE - creates a new database ALTER DATABASE - modifies a database CREATE TABLE - creates a new table ALTER TABLE - modifies a table DROP TABLE - deletes a table CREATE INDEX - creates an index (search key) DROP INDEX - deletes an index SELECT The SELECT statement is used to select data from a database.\nThe data returned is stored in a result table, called the result-set. SELECT column1, column2, ... FROM table_name; SELECT DISTINCT The SELECT DINSTINCT statement is used to return only distinct (different) values.\nInside a table, a column often contains many duplicate values; and sometimes you only want to list the different (distinct) values. SELECT DISTINCT column1, column2, ... FROM table_name; WHERE The WHERE clause is used to filter records.\nIt is used to extract only those records that fultill a specified condition. SELECT column1, column2, ... FROM table_name WHERE condition; Operators can be used in the WHERE clause: \\(\\begin{array}{|c|l|}\\hline \\text{Operator}\u0026\\text{Description}\\\\\\hline \\text{=}\u0026\\text{Equal}\\\\\\hline \\text{\u003e}\u0026\\text{Greater than}\\\\\\hline \\text{\u003c}\u0026\\text{Less than}\\\\\\hline \\text{\u003e=}\u0026\\text{Greater than or equal}\\\\\\hline \\text{\u003c=}\u0026\\text{Less than or equal}\\\\\\hline \\text{\u003c\u003e, !=}\u0026\\text{Not equal}\\\\\\hline \\text{BETWEEN}\u0026\\text{Between a certain range}\\\\\\hline \\text{LIKE}\u0026\\text{Search for a pattern}\\\\\\hline \\text{IN}\u0026\\text{To specify multiple possible values for a column}\\\\\\hline \\end{array}\\) AND, OR, NOT THE WHERE clause can be combined with AND, OR, and NOT operators.\nThe AND and OR operators are used to filter records based on more than one condition: The AND operator displays a record if all the conditons separated by AND are TRUE. The OR operator displays a record if any of the conditons separated by OR is TRUE. THE NOT operator display a record if the condition(s) it NOT TRUE. SELECT column1, column2, ... FROM table_name; WHERE NOT condition1 AND condition2 OR condition3 ...; ORDER BY The ORDER BY keyword is used to sort the result-set in ascending or descending order. The ORDER BY keyword sorts the records in ascending order by default.\nTo sort the records in descending order, used DESC keyword. SELECT column1, column2, ... FROM table_name ORDER BY column1, column2, ... ASC|DESC; INSERT INTO The INSERT INTO statement is used to insert new records in a table. Specify both the column names and the values to be inserted: INSERT INTO table_name (column1, column2, column3, ...) VALUES (value1, value2, value3, ...); If you are adding values for all the columns of the table, you do not need to specify the column names in the SQL query. However, make sure the order of the values is in the same order as the columns in the table. Here, the INSERT INTO syntax would be as follows: INSERT INTO table_name VALUES (value1, value2, value3, ...); IS NULL, IS NOT NULL What is a NULL Value?\nA field with a NULL value is a field with no value.\nIf a field in a table is optional, it is possible to insert a new record or update a record without adding a value to this field. Then the field will be saved with a NULL value. A NULL value is different from a zero value or a field that contains spaces. A field with a NULL value is one that has been left blank during record creation. How to test for NULL Values?\nUse the IS NULL and IS NOT NULL operators. SELECT column_names FROM table_name WHERE column_name IS NULL|IS NOT NULL; UPDATE The UPDATE statement is used to modify the existing records in a table. UPDATE table_name SET columns1 = value1, column2 = value2, ... WHERE condition; DELETE The DELETE statement is used to delete existing records in a table. DELETE FROM table_name WHERE condition; TOP, LIMIT, FETCH FIRST, ROWNUM The SELECT TOP clause is used to specify the number of records to return. The SELECT TOP clause is useful on large tables with thousands of records.\nReturning a large number of records can impact performance. Note: Not all database systems support the SELECT TOP clause.\nMySQL supports the LIMIT clause to select a limited number of records,\nwhile Oracle uses FETCH FIRST n ROWS ONLY and ROWNUM.\nSQL Server/Ms Access: SELECT TOP number|percent column_names(s) FROM table_name WHERE condition; MySQL: SELECT column_names(s) FROM table_name WHERE condition LIMIT number; Oracle 12: SELECT column_names(s) FROM table_name ORDER BY column_name(s) FETCH FIRST number ROWS only; Older Oracle: SELECT column_names(s) FROM table_name WHERE ROWNUM \u003c= number; Older Oracle(with ORDER BY) SELECT * FROM ( SELECT column_name(s) FROM table_name ORDER BY column_name(s) ) WHERE ROWNUM \u003c= number; MIN() The MIN() function returns the smallest value of the selected column. SELECT MIN(column_name) FROM table_name WHERE condition; MAX() The MAX() function returns the largest value of the selected column. SELECT MAX(column_name) FROM table_name WHERE condition; COUNT() The COUNT() function returns the number of rows that matches a specified criterion. SELECT COUNT(column_name) FROM table_name WHERE condition; AVG() The AVG() function returns the average value of a numeric column. SELECT AVG(column_name) FROM table_name WHERE condition; SUM() The SUM() function returns the total sum of a numeric column. SELECT SUM(column_name) FROM table_name WHERE condition; LIKE Operator The LIKE operator is used in a WHERE clause to search for a specified pattern in a column. There are two wildcards often used in conjunction with LIKE operator: The percent sign(%) represents zero, one, or multiple characters The underscore sign(_) represents one, single character Note: Ms Access uses an asterisk(*) instead of the percent sign(%), and a question mark(?) instead of the underscore(_).\nSELECT column1, column2 FROM table_name WHERE columnN LIKE '_a%'; Wildcards A wildcard character is used to substitute one or more characters in a string.\nWildcard characters are used with LIKE operator. The LIKE operator is used in a WHERE clause to search for a specified pattern in a column.\nMS Access:\nSymbal Description Example * Represents zero or more characters bl* finds bl, black, blue, and blob ? Represents a single character h?t finds hot, hat, and hit [] Represents any single character within the brackets h[oa]t finds hot and hat ! Represents any character not in the brackets h[!oa]t finds hit - Represents any single character within the specified range c[a-b]t finds cat and cbt # Represents any single numeric character 2#5 finds 205,215,225,235,245,255,265,275,285,295 SQL Server:\nSymbal Description Example % Represents zero or more characters bl% finds bl, black, blue, and blob _ Represents a single character h_t finds hot, hat, and hit [] Represents any single character within the brackets h[oa]t finds hot and hat ^ Represents any character not in the brackets h[^oa]t finds hit - Represents any single character within the specified range c[a-b]t finds cat and cbt IN The IN operator allows you to specify multiple values in a WHERE clause.\nThe IN operator is a short hand for multiple OR conditinos. SELECT column_name(s) FROM table_name WHERE column_name IN (value1, value2, ...); or\nSELECT column_name(s) FROM table_name WHERE column_name IN (SELECT STATEMENT); BETWEEN The BETWEEN operator selects values within a given range. The values can be numbers, text, or dates.\nThe BETWEEN operator is inclusive: begin and end values are included. SELECT column_name(s) FROM table_name WHERE column_name BETWEEN value1 AND value2; Aliases SQL aliases are used to give a table, or a column in a table, a temporary name.\nAliases are often used to make column names more readable.\nAn alias only exists for the duration of that query.\nAn alias is created with the AS keyword.\nAlias Column Syntax\nSELECT column_name AS alias_name FROM table_name; Alias Table syntax SELECT column_name(s) FROM table_name AS alias_name; Joins A JOIN clause is used to combine rows from two ormore tables, based on a related column between them. Orderes\nOrderId CustomerID OrderDate 10308 2 1996-09-18 10309 37 1996-09-19 10310 77 1996-09-20 Customers\nCustomerID CustomerName ContactName Country 1 Alfreds Futterkiste Maria Anders Germany 2 Ana Trujillo Emparedados y helados Ana Trujillo Mexico 3 Antonio Moreno Taqueria Antonio Moreno Mexico SELECT Orders.OrderID, Customers.CustomerName, Orders.OrderDate FROM Orders INNER JOIN Customers ON Orders.CustomerID=Customers.CustomerID; Result\nOrderID CustomerName OrderDate 10308 Ana Trujillo Emparedados y helados 9/18/1996 10365 Antonio Moreno Taquería 11/27/1996 10383 Around the Horn 12/16/1996 10355 Around the Horn 11/15/1996 10278 Berglunds snabbköp 8/12/1996 INNER JOIN The INNER JOIN keyword selects records that have matching values in both tables. SELECT column_name(s) FROM table1 INNER JOIN table2 ON table1.column_name = table2.column_name; LEFT JOIN The LEFT JOIN keyword returns all records from the left table(table1), and the matching records from the right table(table2). The result is 0 records from the right side, if there is no match. SELECT column_name(s) FROM table1 LEFT JOIN table2 ON table1.column_name = table2.column_name; RIGHT JOIN (RIGHT OUTER JOIN) The RIGHT JOIN keyword returns all records from the right table(table2), and the matching records from the left table (table1). The result is 0 records from the left side, if there is no match. SELECT column_name(s) FROM table1 RIGHT JOIN table2 ON table1.column_name = table2.column_name; FULL JOIN (FULL OUTER JOIN) The FULL JOIN keyword returns all records when there is a match in left(table1) or right (table2) table records. SELECT column_name(s) FROM table1 FULL JOIN table2 ON table1.column_name = table2.column_name WHERE condition; Self Join A self join is a regular join, but the table is joined with itself. SELECT column_name(s) FROM table1 T1, table1 T2 WHERE condition; Customers\nCustomerID CustomerName ContactName Address City PostalCode Country 1 Alfreds Futterkiste Maria Anders Obere Str. 57 Berlin 12209 Germany 2 Ana Trujillo Emparedados y helados Ana Trujillo Avda. de la Constitución 2222 México D.F. 05021 Mexico 3 Antonio Moreno Taquería Antonio Moreno Mataderos 2312 México D.F. 05023 Mexico SELECT A.CustomerName AS CustomerName1, B.CustomerName AS CustomerName2, A.City FROM Customers A, Customers B WHERE A.CustomerID \u003c\u003e B.CustomerID AND A.City = B.City ORDER BY A.City; UNION The UNION operator is ued to combine the result-set of two or more SELECT statements. Every SELECT statement within UNION must have the same number of columns The columns must also have similar data types The columns in every SELECT statement must also be in the same order. SELECT column_name(s) FROM table1 UNION SELECT column_name(s) FROM table2 The UNION operator selects only distinct values by default. To allow deuplicate values, use UNION ALL: SELECT column_name(s) FROM table1 UNION ALL SELECT column_name(s) FROM table2 Note: The column names in the result-set are usually equal to the column names in the first SELECT statement.\nGROUP BY The GROUP BY statement groups rows that have the same values into summary rows, like “find the number of customers in each country”. The GROUP BY statment is often used with aggregate functions (COUNT(),MAX(),MIN(),SUM(),AVG()) to group the result-set by one ore more columns. SELECT column_name(s) FROM table_name WHERE condition GROUP BY column_name(s) ORDER BY column_name(s); HAVING The HAVING clause was added to SQL because the WHERE keyword cannot be used with aggregate functions. SELECT column_name(s) FROM table_name WHERE conditon GROUP BY column_name(s) HAVING condition ORDER BY column_name(s); Sample SELECT COUNT(CustomerID), Country FROM Customers GROUP BY Country HAVING COUNT(CustomerID) \u003e 5; EXISTS The EXISTS operator is used to test for the existence of any record in a subquery. The EXISTS operator returns TRUE if the subquery returns one or more records. SELECT column_name(s) FROM table_name WHERE EXISTS (SELECT column_name(s) FROM table_name WHERE condition ); ANY The ANY operator: returns a boolean value as a result returns TRUE if ANY of the subquery values meet the condition ANY means that the conditon will be true if the operation is true for any of the values in the range. SELECT column_name(s) FROM table_name WHERE column_name(s) opeartor ANY (SELECT column_name FROM table_name WHERE condition); ALL The ALL opeartor: returns a boolean value as a result returns TRUE if ALL of the subquery values meet the conditon is used with SELECT, WHERE and HAVING statements ALL means that the conditon will be true only if the operation is true for all values in the range. SELECT ALL column_name(s) FROM table_name WHERE conditon syntax with WHRER or HAVING SELECT column_name(s) FROM table_name WHERE column_name operator ALL (SELECT column_name FROM table_name WHERE condition); SELECT INTO The SELECT INTO statement copies data from one table into a new table.\nCopy all columns into a new table:\nSELECT * INTO newtable [IN externaldb] FROM oldtable WHERE condition Copy only some columns into a new table: SELECT column1, column2, column3, ... INTO new table [IN externaldb] FROM oldtable WHERE condition; INSERT INTO SELECT The INSERT INTO SELECT statement copies data from one table and inserts it into another table. The INSERT INTO SELECT statement requires that the data types in source and target tables match. Note: The existing records in the target table are unaffected.\nCopy all columns from one table to another table: INSERT INTO table2 SELECT * FROM table1 WHERE condition Copy only some columns from one table into another table: INSERT INTO table2 (column1, column2, column3, ...) SELECT column1, column2, column3, ... FROM table1 WHERE condition CASE The CASE expression goes through conditions and returns a value when the first condition is met (like an if-then-else statement). So, once a condition is true, it will stop reading and return the result. If no conditions are true, it returns the value in the ELSE cluase. If there is no ELSE part and no condtions are true, it retures NULL. CASE WHEN conditon1 THEN result1 WHEN conditon2 THEN result2 WHEN conditonN THEN resultN ELSE resuklt END NULL Functions Products |P_Id|ProductName|UnitPrice|UnitsInStock|UnitsOnOrder| |1|Jarlsberg|10.45|16|15| |2|Mascarpone|32.56|23| | |3|Gorgonzola|15.67|9|20|\nSuppose that the “UnitsOnOrder” column is optional, and may contain NULL values.\nMySQL\nINFULL() SELECT ProductName, UnitPrice * (UnitsInStock + IFNULL(UnitsOnOrder, 0)) FROM Products; COALESCE() SELECT ProductName, UnitPrice * (UnitsInStock + COALESCE(UnitsOnOrder, 0)) FROM Products; SQL Server ISNULL() SELECT ProductName, UnitPrice * (UnitsInStock + ISNULL(UnitsOnOrder, 0)) FROM Products; COALESCE() SELECT ProductName, UnitPrice * (UnitsInStock + COALESCE(UnitsOnOrder, 0)) FROM Products; MS Access IsNULL() SELECT ProductName, UnitPrice * (UnitsInStock + IIF(IsNull(UnitsOnOrder), 0, UnitsOnOrder)) FROM Products; Oracle NVL() SELECT ProductName, UnitPrice * (UnitsInStock + NVL(UnitsOnOrder, 0)) FROM Products; COALESCE() SELECT SELECT ProductName, UnitPrice * (UnitsInStock + COALESCE(UnitsOnOrder, 0)) FROM Products; Sotred Precedures A stored procedure is a prepared SQL code that you can save, so the code can be reused over and over again.\nSo if you have an SQL query that you write over and over again, save it as a stored procedure, and then just call it to execute it.\nYou can also pass parameters to a stored procedure, so that the stored procedure can act based on the parameter value(s) that is passed.\nStored Procedure Syntax\nCREATE PROCEDURE procedure_name AS sql_statement GO; ** Execute as Stored Procedure\nEXEC procedure_name; Comments Single line comments --. Multi-line comments /* and */. ","wordCount":"2576","inLanguage":"zh-tw","datePublished":"2022-09-01T13:28:14+08:00","dateModified":"2022-09-01T13:28:14+08:00","author":{"@type":"Person","name":"Rain Hu"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://intervalrain.github.io/it/sql/"},"publisher":{"@type":"Organization","name":"Rain Hu's Workspace","logo":{"@type":"ImageObject","url":"https://intervalrain.github.io/images/rain.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://intervalrain.github.io/ accesskey=h title="Rain Hu's Workspace (Alt + H)"><img src=https://intervalrain.github.io/images/rain.png alt aria-label=logo height=35>Rain Hu's Workspace</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://intervalrain.github.io/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://intervalrain.github.io/aboutme title="About me"><span>About me</span></a></li><li><a href=https://intervalrain.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://intervalrain.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://intervalrain.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://intervalrain.github.io/csharp/csharp title=C#><span>C#</span></a></li><li><a href=https://intervalrain.github.io/csindex title=CS><span>CS</span></a></li><li><a href=https://intervalrain.github.io/leetcode title=LeetCode><span>LeetCode</span></a></li><li><a href=https://intervalrain.github.io/ai title=AI><span>AI</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://intervalrain.github.io/>首頁</a>&nbsp;»&nbsp;<a href=https://intervalrain.github.io/it/>ITs</a></div><h1 class="post-title entry-hint-parent">[IT] SQL</h1><div class=post-description>Base command of SQL</div><div class=post-meta><span title='2022-09-01 13:28:14 +0800 +0800'>September 1, 2022</span>&nbsp;·&nbsp;13 分鐘&nbsp;·&nbsp;Rain Hu&nbsp;|&nbsp;<a href=https://github.com/intervalrain/intervalrain.github.io/tree/main/content//IT/SQL.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目錄</span></summary><div class=inner><ul><li><a href=#introduction aria-label=Introduction>Introduction</a><ul><li><a href=#what-is-sql aria-label="What is SQL?">What is SQL?</a></li><li><a href=#rdbms aria-label=RDBMS>RDBMS</a></li></ul></li><li><a href=#syntax aria-label=Syntax>Syntax</a><ul><li><a href=#most-important-sql-commands aria-label="Most Important SQL Commands">Most Important SQL Commands</a></li><li><a href=#select aria-label=SELECT>SELECT</a></li><li><a href=#select-distinct aria-label="SELECT DISTINCT">SELECT DISTINCT</a></li><li><a href=#where aria-label=WHERE>WHERE</a></li><li><a href=#and-or-not aria-label="AND, OR, NOT">AND, OR, NOT</a></li><li><a href=#order-by aria-label="ORDER BY">ORDER BY</a></li><li><a href=#insert-into aria-label="INSERT INTO">INSERT INTO</a></li><li><a href=#is-null-is-not-null aria-label="IS NULL, IS NOT NULL">IS NULL, IS NOT NULL</a></li><li><a href=#update aria-label=UPDATE>UPDATE</a></li><li><a href=#delete aria-label=DELETE>DELETE</a></li><li><a href=#top-limit-fetch-first-rownum aria-label="TOP, LIMIT, FETCH FIRST, ROWNUM">TOP, LIMIT, FETCH FIRST, ROWNUM</a></li><li><a href=#min aria-label=MIN()>MIN()</a></li><li><a href=#max aria-label=MAX()>MAX()</a></li><li><a href=#count aria-label=COUNT()>COUNT()</a></li><li><a href=#avg aria-label=AVG()>AVG()</a></li><li><a href=#sum aria-label=SUM()>SUM()</a></li><li><a href=#like-operator aria-label="LIKE Operator">LIKE Operator</a></li><li><a href=#wildcards aria-label=Wildcards>Wildcards</a></li><li><a href=#in aria-label=IN>IN</a></li><li><a href=#between aria-label=BETWEEN>BETWEEN</a></li><li><a href=#aliases aria-label=Aliases>Aliases</a></li><li><a href=#joins aria-label=Joins>Joins</a></li><li><a href=#inner-join aria-label="INNER JOIN">INNER JOIN</a></li><li><a href=#left-join aria-label="LEFT JOIN">LEFT JOIN</a></li><li><a href=#right-join-right-outer-join aria-label="RIGHT JOIN (RIGHT OUTER JOIN)">RIGHT JOIN (RIGHT OUTER JOIN)</a></li><li><a href=#full-join-full-outer-join aria-label="FULL JOIN (FULL OUTER JOIN)">FULL JOIN (FULL OUTER JOIN)</a></li><li><a href=#self-join aria-label="Self Join">Self Join</a></li><li><a href=#union aria-label=UNION>UNION</a></li><li><a href=#group-by aria-label="GROUP BY">GROUP BY</a></li><li><a href=#having aria-label=HAVING>HAVING</a></li><li><a href=#exists aria-label=EXISTS>EXISTS</a></li><li><a href=#any aria-label=ANY>ANY</a></li><li><a href=#all aria-label=ALL>ALL</a></li><li><a href=#select-into aria-label="SELECT INTO">SELECT INTO</a></li><li><a href=#insert-into-select aria-label="INSERT INTO SELECT">INSERT INTO SELECT</a></li><li><a href=#case aria-label=CASE>CASE</a></li><li><a href=#null-functions aria-label="NULL Functions">NULL Functions</a></li><li><a href=#sotred-precedures aria-label="Sotred Precedures">Sotred Precedures</a></li><li><a href=#comments aria-label=Comments>Comments</a></li></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h1 id=introduction>Introduction<a hidden class=anchor aria-hidden=true href=#introduction>#</a></h1><h2 id=what-is-sql>What is SQL?<a hidden class=anchor aria-hidden=true href=#what-is-sql>#</a></h2><ul><li>SQL stands for <strong>Structured Query Language</strong></li><li>SQL lets you access and manipualate databases</li><li>SQL becaome a standard of the American National Standards Institute (ANSI) in 1986, and of the International Organization for Standardization (ISO) in 1987</li></ul><h2 id=rdbms>RDBMS<a hidden class=anchor aria-hidden=true href=#rdbms>#</a></h2><ul><li>RDBMS stands for <strong>Relational Database Management System</strong>.</li><li>RDBMS is the basis for SQL, and for all modern database systems such as MS SQL Server, IBM DB2, Oracle, MySQL, and Microsoft Access.</li><li>The data in RDBMS is stored in database objects called tables. A table is a collection of related data entries and it consists of columns and rows.</li></ul><h1 id=syntax>Syntax<a hidden class=anchor aria-hidden=true href=#syntax>#</a></h1><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> Customers;
</span></span></code></pre></div><ul><li>SQL keywords are NOT case sensitive.</li><li>Some database systems requires a semicolon at the end of each SQL statement.</li><li>Semicolon is the standard way to separate each SQL statement in database systems that allow more than one SQL statement to be executed in the same call to the server.</li></ul><h2 id=most-important-sql-commands>Most Important SQL Commands<a hidden class=anchor aria-hidden=true href=#most-important-sql-commands>#</a></h2><ul><li><code>SELECT</code> - extracts data from a database</li><li><code>UPDATE</code> - updates data in a database</li><li><code>DELETE</code> - deletes data from a database</li><li><code>INSERT INTO</code> - inserts new data into a database</li><li><code>CREATE DATABASE</code> - creates a new database</li><li><code>ALTER DATABASE</code> - modifies a database</li><li><code>CREATE TABLE</code> - creates a new table</li><li><code>ALTER TABLE</code> - modifies a table</li><li><code>DROP TABLE</code> - deletes a table</li><li><code>CREATE INDEX</code> - creates an index (search key)</li><li><code>DROP INDEX</code> - deletes an index</li></ul><h2 id=select>SELECT<a hidden class=anchor aria-hidden=true href=#select>#</a></h2><ul><li>The <code>SELECT</code> statement is used to select data from a database.<br>The data returned is stored in a result table, called the result-set.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> column1, column2, ...
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>;
</span></span></code></pre></div><h2 id=select-distinct>SELECT DISTINCT<a hidden class=anchor aria-hidden=true href=#select-distinct>#</a></h2><ul><li>The <code>SELECT DINSTINCT</code> statement is used to return only distinct (different) values.<br>Inside a table, a column often contains many duplicate values; and sometimes you only want to list the different (distinct) values.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>DISTINCT</span> column1, column2, ...
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>;
</span></span></code></pre></div><h2 id=where>WHERE<a hidden class=anchor aria-hidden=true href=#where>#</a></h2><ul><li>The <code>WHERE</code> clause is used to filter records.<br>It is used to extract only those records that fultill a specified condition.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> column1, column2, ...
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> condition;
</span></span></code></pre></div><ul><li>Operators can be used in the <code>WHERE</code> clause:
\(\begin{array}{|c|l|}\hline
\text{Operator}&\text{Description}\\\hline
\text{=}&\text{Equal}\\\hline
\text{>}&\text{Greater than}\\\hline
\text{&lt;}&\text{Less than}\\\hline
\text{>=}&\text{Greater than or equal}\\\hline
\text{&lt;=}&\text{Less than or equal}\\\hline
\text{&lt;>, !=}&\text{Not equal}\\\hline
\text{BETWEEN}&\text{Between a certain range}\\\hline
\text{LIKE}&\text{Search for a pattern}\\\hline
\text{IN}&\text{To specify multiple possible values for a column}\\\hline
\end{array}\)</li></ul><h2 id=and-or-not>AND, OR, NOT<a hidden class=anchor aria-hidden=true href=#and-or-not>#</a></h2><ul><li>THE <code>WHERE</code> clause can be combined with <code>AND</code>, <code>OR</code>, and <code>NOT</code> operators.<br>The <code>AND</code> and <code>OR</code> operators are used to filter records based on more than one condition:<ul><li>The <code>AND</code> operator displays a record if all the conditons separated by <code>AND</code> are TRUE.</li><li>The <code>OR</code> operator displays a record if any of the conditons separated by <code>OR</code> is TRUE.</li><li>THE <code>NOT</code> operator display a record if the condition(s) it NOT TRUE.</li></ul></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> column1, column2, ...
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>;
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> <span style=color:#66d9ef>NOT</span> condition1 <span style=color:#66d9ef>AND</span> condition2 <span style=color:#66d9ef>OR</span> condition3 ...;
</span></span></code></pre></div><h2 id=order-by>ORDER BY<a hidden class=anchor aria-hidden=true href=#order-by>#</a></h2><ul><li>The <code>ORDER BY</code> keyword is used to sort the result-set in ascending or descending order.</li><li>The <code>ORDER BY</code> keyword sorts the records in ascending order by default.<br>To sort the records in descending order, used <code>DESC</code> keyword.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> column1, column2, ...
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> column1, column2, ... <span style=color:#66d9ef>ASC</span><span style=color:#f92672>|</span><span style=color:#66d9ef>DESC</span>;
</span></span></code></pre></div><h2 id=insert-into>INSERT INTO<a hidden class=anchor aria-hidden=true href=#insert-into>#</a></h2><ul><li>The <code>INSERT INTO</code> statement is used to insert new records in a table.</li></ul><ol><li>Specify both the column names and the values to be inserted:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> <span style=color:#66d9ef>table_name</span> (column1, column2, column3, ...)
</span></span><span style=display:flex><span><span style=color:#66d9ef>VALUES</span> (value1, value2, value3, ...);
</span></span></code></pre></div><ol start=2><li>If you are adding values for all the columns of the table, you do not need to specify the column names in the SQL query. However, make sure the order of the values is in the same order as the columns in the table. Here, the <code>INSERT INTO</code> syntax would be as follows:</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>VALUES</span> (value1, value2, value3, ...);
</span></span></code></pre></div><h2 id=is-null-is-not-null>IS NULL, IS NOT NULL<a hidden class=anchor aria-hidden=true href=#is-null-is-not-null>#</a></h2><ul><li><p>What is a NULL Value?</p><ul><li>A field with a NULL value is a field with no value.<br>If a field in a table is optional, it is possible to insert a new record or update a record without adding a value to this field. Then the field will be saved with a NULL value.</li><li>A NULL value is different from a zero value or a field that contains spaces. A field with a NULL value is one that has been left blank during record creation.</li></ul></li><li><p>How to test for NULL Values?</p><ul><li>Use the <code>IS NULL</code> and <code>IS NOT NULL</code> operators.</li></ul></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> column_names
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> <span style=color:#66d9ef>column_name</span> <span style=color:#66d9ef>IS</span> <span style=color:#66d9ef>NULL</span><span style=color:#f92672>|</span><span style=color:#66d9ef>IS</span> <span style=color:#66d9ef>NOT</span> <span style=color:#66d9ef>NULL</span>;
</span></span></code></pre></div><h2 id=update>UPDATE<a hidden class=anchor aria-hidden=true href=#update>#</a></h2><ul><li>The <code>UPDATE</code> statement is used to modify the existing records in a table.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>UPDATE</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SET</span> columns1 <span style=color:#f92672>=</span> value1, column2 <span style=color:#f92672>=</span> value2, ...
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> condition;
</span></span></code></pre></div><h2 id=delete>DELETE<a hidden class=anchor aria-hidden=true href=#delete>#</a></h2><ul><li>The <code>DELETE</code> statement is used to delete existing records in a table.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>DELETE</span> <span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> condition;
</span></span></code></pre></div><h2 id=top-limit-fetch-first-rownum>TOP, LIMIT, FETCH FIRST, ROWNUM<a hidden class=anchor aria-hidden=true href=#top-limit-fetch-first-rownum>#</a></h2><ul><li>The <code>SELECT TOP</code> clause is used to specify the number of records to return.</li><li>The <code>SELECT TOP</code> clause is useful on large tables with thousands of records.<br>Returning a large number of records can impact performance.</li></ul><blockquote><p><em>Note:</em> Not all database systems support the <code>SELECT TOP</code> clause.<br>MySQL supports the <code>LIMIT</code> clause to select a limited number of records,<br>while Oracle uses <code>FETCH FIRST n ROWS ONLY</code> and <code>ROWNUM</code>.</p></blockquote><ul><li><strong>SQL Server/Ms Access:</strong></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> TOP number<span style=color:#f92672>|</span>percent column_names(s)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> condition;
</span></span></code></pre></div><ul><li><strong>MySQL:</strong></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> column_names(s)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> condition
</span></span><span style=display:flex><span><span style=color:#66d9ef>LIMIT</span> number;
</span></span></code></pre></div><ul><li><strong>Oracle 12:</strong></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> column_names(s)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> <span style=color:#66d9ef>column_name</span>(s)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FETCH</span> <span style=color:#66d9ef>FIRST</span> number <span style=color:#66d9ef>ROWS</span> <span style=color:#66d9ef>only</span>;
</span></span></code></pre></div><ul><li><strong>Older Oracle:</strong></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> column_names(s)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> ROWNUM <span style=color:#f92672>&lt;=</span> number;
</span></span></code></pre></div><ul><li><strong>Older Oracle(with ORDER BY)</strong></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> (
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span>(s)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> <span style=color:#66d9ef>column_name</span>(s)
</span></span><span style=display:flex><span>    )
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> ROWNUM <span style=color:#f92672>&lt;=</span> number;
</span></span></code></pre></div><h2 id=min>MIN()<a hidden class=anchor aria-hidden=true href=#min>#</a></h2><ul><li>The <code>MIN()</code> function returns the smallest value of the selected column.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>MIN</span>(<span style=color:#66d9ef>column_name</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> condition;
</span></span></code></pre></div><h2 id=max>MAX()<a hidden class=anchor aria-hidden=true href=#max>#</a></h2><ul><li>The <code>MAX()</code> function returns the largest value of the selected column.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>MAX</span>(<span style=color:#66d9ef>column_name</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> condition;
</span></span></code></pre></div><h2 id=count>COUNT()<a hidden class=anchor aria-hidden=true href=#count>#</a></h2><ul><li>The <code>COUNT()</code> function returns the number of rows that matches a specified criterion.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>COUNT</span>(<span style=color:#66d9ef>column_name</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> condition;
</span></span></code></pre></div><h2 id=avg>AVG()<a hidden class=anchor aria-hidden=true href=#avg>#</a></h2><ul><li>The <code>AVG()</code> function returns the average value of a numeric column.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>AVG</span>(<span style=color:#66d9ef>column_name</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> condition;
</span></span></code></pre></div><h2 id=sum>SUM()<a hidden class=anchor aria-hidden=true href=#sum>#</a></h2><ul><li>The <code>SUM()</code> function returns the total sum of a numeric column.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>SUM</span>(<span style=color:#66d9ef>column_name</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> condition;
</span></span></code></pre></div><h2 id=like-operator>LIKE Operator<a hidden class=anchor aria-hidden=true href=#like-operator>#</a></h2><ul><li>The <code>LIKE</code> operator is used in a <code>WHERE</code> clause to search for a specified pattern in a column.</li><li>There are two wildcards often used in conjunction with <code>LIKE</code> operator:<ul><li>The percent sign(%) represents zero, one, or multiple characters</li><li>The underscore sign(_) represents one, single character</li></ul></li></ul><blockquote><p><em>Note:</em> Ms Access uses an asterisk(*) instead of the percent sign(%), and a question mark(?) instead of the underscore(_).</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> column1, column2
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> columnN <span style=color:#66d9ef>LIKE</span> <span style=color:#e6db74>&#39;_a%&#39;</span>;
</span></span></code></pre></div><h2 id=wildcards>Wildcards<a hidden class=anchor aria-hidden=true href=#wildcards>#</a></h2><ul><li><p>A wildcard character is used to substitute one or more characters in a string.<br>Wildcard characters are used with <code>LIKE</code> operator. The <code>LIKE</code> operator is used in a <code>WHERE</code> clause to search for a specified pattern in a column.</p></li><li><p><strong>MS Access:</strong></p><table><thead><tr><th>Symbal</th><th>Description</th><th>Example</th></tr></thead><tbody><tr><td>*</td><td>Represents zero or more characters</td><td>bl* finds bl, black, blue, and blob</td></tr><tr><td>?</td><td>Represents a single character</td><td>h?t finds hot, hat, and hit</td></tr><tr><td>[]</td><td>Represents any single character within the brackets</td><td>h[oa]t finds hot and hat</td></tr><tr><td>!</td><td>Represents any character not in the brackets</td><td>h[!oa]t finds hit</td></tr><tr><td>-</td><td>Represents any single character within the specified range</td><td>c[a-b]t finds cat and cbt</td></tr><tr><td>#</td><td>Represents any single numeric character</td><td>2#5 finds 205,215,225,235,245,255,265,275,285,295</td></tr></tbody></table></li><li><p><strong>SQL Server:</strong></p><table><thead><tr><th>Symbal</th><th>Description</th><th>Example</th></tr></thead><tbody><tr><td>%</td><td>Represents zero or more characters</td><td>bl% finds bl, black, blue, and blob</td></tr><tr><td>_</td><td>Represents a single character</td><td>h_t finds hot, hat, and hit</td></tr><tr><td>[]</td><td>Represents any single character within the brackets</td><td>h[oa]t finds hot and hat</td></tr><tr><td>^</td><td>Represents any character not in the brackets</td><td>h[^oa]t finds hit</td></tr><tr><td>-</td><td>Represents any single character within the specified range</td><td>c[a-b]t finds cat and cbt</td></tr></tbody></table></li></ul><h2 id=in>IN<a hidden class=anchor aria-hidden=true href=#in>#</a></h2><ul><li>The <code>IN</code> operator allows you to specify multiple values in a <code>WHERE</code> clause.<br>The <code>IN</code> operator is a short hand for multiple <code>OR</code> conditinos.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span>(s)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> <span style=color:#66d9ef>column_name</span> <span style=color:#66d9ef>IN</span> (value1, value2, ...);
</span></span></code></pre></div><p>or</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span>(s)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> <span style=color:#66d9ef>column_name</span> <span style=color:#66d9ef>IN</span> (<span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>STATEMENT</span>);
</span></span></code></pre></div><h2 id=between>BETWEEN<a hidden class=anchor aria-hidden=true href=#between>#</a></h2><ul><li>The <code>BETWEEN</code> operator selects values within a given range. The values can be numbers, text, or dates.<br>The <code>BETWEEN</code> operator is <strong>inclusive</strong>: begin and end values are included.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span>(s)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> <span style=color:#66d9ef>column_name</span> <span style=color:#66d9ef>BETWEEN</span> value1 <span style=color:#66d9ef>AND</span> value2;
</span></span></code></pre></div><h2 id=aliases>Aliases<a hidden class=anchor aria-hidden=true href=#aliases>#</a></h2><ul><li><p>SQL aliases are used to give a table, or a column in a table, a temporary name.<br>Aliases are often used to make column names more readable.<br>An alias only exists for the duration of that query.<br>An alias is created with the <code>AS</code> keyword.</p></li><li><p>Alias Column Syntax</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span> <span style=color:#66d9ef>AS</span> alias_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>;
</span></span></code></pre></div><ul><li>Alias Table syntax</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span>(s)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span> <span style=color:#66d9ef>AS</span> alias_name;
</span></span></code></pre></div><h2 id=joins>Joins<a hidden class=anchor aria-hidden=true href=#joins>#</a></h2><ul><li>A <code>JOIN</code> clause is used to combine rows from two ormore tables, based on a related column between them.</li></ul><p><strong>Orderes</strong></p><table><thead><tr><th>OrderId</th><th>CustomerID</th><th>OrderDate</th></tr></thead><tbody><tr><td>10308</td><td>2</td><td>1996-09-18</td></tr><tr><td>10309</td><td>37</td><td>1996-09-19</td></tr><tr><td>10310</td><td>77</td><td>1996-09-20</td></tr></tbody></table><p><strong>Customers</strong></p><table><thead><tr><th>CustomerID</th><th>CustomerName</th><th>ContactName</th><th>Country</th></tr></thead><tbody><tr><td>1</td><td>Alfreds Futterkiste</td><td>Maria Anders</td><td>Germany</td></tr><tr><td>2</td><td>Ana Trujillo Emparedados y helados</td><td>Ana Trujillo</td><td>Mexico</td></tr><tr><td>3</td><td>Antonio Moreno Taqueria</td><td>Antonio Moreno</td><td>Mexico</td></tr></tbody></table><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> Orders.OrderID, Customers.CustomerName, Orders.OrderDate
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> Orders
</span></span><span style=display:flex><span><span style=color:#66d9ef>INNER</span> <span style=color:#66d9ef>JOIN</span> Customers <span style=color:#66d9ef>ON</span> Orders.CustomerID<span style=color:#f92672>=</span>Customers.CustomerID;
</span></span></code></pre></div><p><strong>Result</strong></p><table><thead><tr><th>OrderID</th><th>CustomerName</th><th>OrderDate</th></tr></thead><tbody><tr><td>10308</td><td>Ana Trujillo Emparedados y helados</td><td>9/18/1996</td></tr><tr><td>10365</td><td>Antonio Moreno Taquería</td><td>11/27/1996</td></tr><tr><td>10383</td><td>Around the Horn</td><td>12/16/1996</td></tr><tr><td>10355</td><td>Around the Horn</td><td>11/15/1996</td></tr><tr><td>10278</td><td>Berglunds snabbköp</td><td>8/12/1996</td></tr></tbody></table><p><img alt="inner join" loading=lazy src=https://www.w3schools.com/sql/img_innerjoin.gif>
<img alt="left join" loading=lazy src=https://www.w3schools.com/sql/img_leftjoin.gif>
<img alt="right join" loading=lazy src=https://www.w3schools.com/sql/img_rightjoin.gif>
<img alt="full outer join" loading=lazy src=https://www.w3schools.com/sql/img_fulljoin.gif></p><h2 id=inner-join>INNER JOIN<a hidden class=anchor aria-hidden=true href=#inner-join>#</a></h2><ul><li>The <code>INNER JOIN</code> keyword selects records that have matching values in both tables.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span>(s)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> table1
</span></span><span style=display:flex><span><span style=color:#66d9ef>INNER</span> <span style=color:#66d9ef>JOIN</span> table2
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> table1.<span style=color:#66d9ef>column_name</span> <span style=color:#f92672>=</span> table2.<span style=color:#66d9ef>column_name</span>;
</span></span></code></pre></div><h2 id=left-join>LEFT JOIN<a hidden class=anchor aria-hidden=true href=#left-join>#</a></h2><ul><li>The <code>LEFT JOIN</code> keyword returns all records from the left table(table1), and the matching records from the right table(table2). The result is 0 records from the right side, if there is no match.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span>(s)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> table1
</span></span><span style=display:flex><span><span style=color:#66d9ef>LEFT</span> <span style=color:#66d9ef>JOIN</span> table2
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> table1.<span style=color:#66d9ef>column_name</span> <span style=color:#f92672>=</span> table2.<span style=color:#66d9ef>column_name</span>;
</span></span></code></pre></div><h2 id=right-join-right-outer-join>RIGHT JOIN (RIGHT OUTER JOIN)<a hidden class=anchor aria-hidden=true href=#right-join-right-outer-join>#</a></h2><ul><li>The <code>RIGHT JOIN</code> keyword returns all records from the right table(table2), and the matching records from the left table (table1). The result is 0 records from the left side, if there is no match.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span>(s)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> table1
</span></span><span style=display:flex><span><span style=color:#66d9ef>RIGHT</span> <span style=color:#66d9ef>JOIN</span> table2
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> table1.<span style=color:#66d9ef>column_name</span> <span style=color:#f92672>=</span> table2.<span style=color:#66d9ef>column_name</span>;
</span></span></code></pre></div><h2 id=full-join-full-outer-join>FULL JOIN (FULL OUTER JOIN)<a hidden class=anchor aria-hidden=true href=#full-join-full-outer-join>#</a></h2><ul><li>The <code>FULL JOIN</code> keyword returns all records when there is a match in left(table1) or right (table2) table records.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span>(s)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> table1
</span></span><span style=display:flex><span><span style=color:#66d9ef>FULL</span> <span style=color:#66d9ef>JOIN</span> table2
</span></span><span style=display:flex><span><span style=color:#66d9ef>ON</span> table1.<span style=color:#66d9ef>column_name</span> <span style=color:#f92672>=</span> table2.<span style=color:#66d9ef>column_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> condition;
</span></span></code></pre></div><h2 id=self-join>Self Join<a hidden class=anchor aria-hidden=true href=#self-join>#</a></h2><ul><li>A self join is a regular join, but the table is joined with itself.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span>(s)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> table1 T1, table1 T2
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> condition;
</span></span></code></pre></div><p><strong>Customers</strong></p><table><thead><tr><th>CustomerID</th><th>CustomerName</th><th>ContactName</th><th>Address</th><th>City</th><th>PostalCode</th><th>Country</th></tr></thead><tbody><tr><td>1</td><td>Alfreds Futterkiste</td><td>Maria Anders</td><td>Obere Str. 57</td><td>Berlin</td><td>12209</td><td>Germany</td></tr><tr><td>2</td><td>Ana Trujillo Emparedados y helados</td><td>Ana Trujillo</td><td>Avda. de la Constitución 2222</td><td>México D.F.</td><td>05021</td><td>Mexico</td></tr><tr><td>3</td><td>Antonio Moreno Taquería</td><td>Antonio Moreno</td><td>Mataderos 2312</td><td>México D.F.</td><td>05023</td><td>Mexico</td></tr></tbody></table><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> A.CustomerName <span style=color:#66d9ef>AS</span> CustomerName1, B.CustomerName <span style=color:#66d9ef>AS</span> CustomerName2, A.City
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> Customers A, Customers B
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> A.CustomerID <span style=color:#f92672>&lt;&gt;</span> B.CustomerID
</span></span><span style=display:flex><span><span style=color:#66d9ef>AND</span> A.City <span style=color:#f92672>=</span> B.City
</span></span><span style=display:flex><span><span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> A.City;
</span></span></code></pre></div><h2 id=union>UNION<a hidden class=anchor aria-hidden=true href=#union>#</a></h2><ul><li>The <code>UNION</code> operator is ued to combine the result-set of two or more <code>SELECT</code> statements.<ul><li>Every <code>SELECT</code> statement within <code>UNION</code> must have the same number of columns</li><li>The columns must also have similar data types</li><li>The columns in every <code>SELECT</code> statement must also be in the same order.</li></ul></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span>(s) <span style=color:#66d9ef>FROM</span> table1
</span></span><span style=display:flex><span><span style=color:#66d9ef>UNION</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span>(s) <span style=color:#66d9ef>FROM</span> table2
</span></span></code></pre></div><ul><li>The <code>UNION</code> operator selects only distinct values by default. To allow deuplicate values, use <code>UNION ALL</code>:</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span>(s) <span style=color:#66d9ef>FROM</span> table1
</span></span><span style=display:flex><span><span style=color:#66d9ef>UNION</span> <span style=color:#66d9ef>ALL</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span>(s) <span style=color:#66d9ef>FROM</span> table2
</span></span></code></pre></div><blockquote><p><em>Note:</em> The column names in the result-set are usually equal to the column names in the first <code>SELECT</code> statement.</p></blockquote><h2 id=group-by>GROUP BY<a hidden class=anchor aria-hidden=true href=#group-by>#</a></h2><ul><li>The <code>GROUP BY</code> statement groups rows that have the same values into summary rows, like &ldquo;find the number of customers in each country&rdquo;.</li><li>The <code>GROUP BY</code> statment is often used with aggregate functions (<code>COUNT()</code>,<code>MAX()</code>,<code>MIN()</code>,<code>SUM()</code>,<code>AVG()</code>) to group the result-set by one ore more columns.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span>(s)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> condition
</span></span><span style=display:flex><span><span style=color:#66d9ef>GROUP</span> <span style=color:#66d9ef>BY</span> <span style=color:#66d9ef>column_name</span>(s)
</span></span><span style=display:flex><span><span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> <span style=color:#66d9ef>column_name</span>(s);
</span></span></code></pre></div><h2 id=having>HAVING<a hidden class=anchor aria-hidden=true href=#having>#</a></h2><ul><li>The <code>HAVING</code> clause was added to SQL because the <code>WHERE</code> keyword cannot be used with aggregate functions.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span>(s)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> conditon
</span></span><span style=display:flex><span><span style=color:#66d9ef>GROUP</span> <span style=color:#66d9ef>BY</span> <span style=color:#66d9ef>column_name</span>(s)
</span></span><span style=display:flex><span><span style=color:#66d9ef>HAVING</span> condition
</span></span><span style=display:flex><span><span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> <span style=color:#66d9ef>column_name</span>(s);
</span></span></code></pre></div><ul><li><strong>Sample</strong></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>COUNT</span>(CustomerID), Country
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> Customers
</span></span><span style=display:flex><span><span style=color:#66d9ef>GROUP</span> <span style=color:#66d9ef>BY</span> Country
</span></span><span style=display:flex><span><span style=color:#66d9ef>HAVING</span> <span style=color:#66d9ef>COUNT</span>(CustomerID) <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>5</span>;
</span></span></code></pre></div><h2 id=exists>EXISTS<a hidden class=anchor aria-hidden=true href=#exists>#</a></h2><ul><li>The <code>EXISTS</code> operator is used to test for the existence of any record in a subquery.</li><li>The <code>EXISTS</code> operator returns TRUE if the subquery returns one or more records.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span>(s)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> <span style=color:#66d9ef>EXISTS</span>
</span></span><span style=display:flex><span>    (<span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span>(s) 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>WHERE</span> condition
</span></span><span style=display:flex><span>    );
</span></span></code></pre></div><h2 id=any>ANY<a hidden class=anchor aria-hidden=true href=#any>#</a></h2><ul><li>The <code>ANY</code> operator:<ul><li>returns a boolean value as a result</li><li>returns TRUE if ANY of the subquery values meet the condition</li></ul></li><li><code>ANY</code> means that the conditon will be true if the operation is true for any of the values in the range.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span>(s)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> <span style=color:#66d9ef>column_name</span>(s) opeartor <span style=color:#66d9ef>ANY</span>
</span></span><span style=display:flex><span>    (<span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span>
</span></span><span style=display:flex><span>     <span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span>     <span style=color:#66d9ef>WHERE</span> condition);
</span></span></code></pre></div><h2 id=all>ALL<a hidden class=anchor aria-hidden=true href=#all>#</a></h2><ul><li>The <code>ALL</code> opeartor:<ul><li>returns a boolean value as a result</li><li>returns TRUE if ALL of the subquery values meet the conditon</li><li>is used with <code>SELECT</code>, <code>WHERE</code> and <code>HAVING</code> statements</li></ul></li><li><code>ALL</code> means that the conditon will be true only if the operation is true for all values in the range.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>ALL</span> <span style=color:#66d9ef>column_name</span>(s)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> conditon
</span></span></code></pre></div><ul><li>syntax with <code>WHRER</code> or <code>HAVING</code></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span>(s)
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> <span style=color:#66d9ef>column_name</span> <span style=color:#66d9ef>operator</span> <span style=color:#66d9ef>ALL</span>
</span></span><span style=display:flex><span>    (<span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>column_name</span>
</span></span><span style=display:flex><span>     <span style=color:#66d9ef>FROM</span> <span style=color:#66d9ef>table_name</span>
</span></span><span style=display:flex><span>     <span style=color:#66d9ef>WHERE</span> condition);
</span></span></code></pre></div><h2 id=select-into>SELECT INTO<a hidden class=anchor aria-hidden=true href=#select-into>#</a></h2><ul><li><p>The <code>SELECT INTO</code> statement copies data from one table into a new table.</p></li><li><p><strong>Copy all columns into a new table:</strong></p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>INTO</span> newtable [<span style=color:#66d9ef>IN</span> externaldb]
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> oldtable
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> condition
</span></span></code></pre></div><ul><li><strong>Copy only some columns into a new table:</strong></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> column1, column2, column3, ...
</span></span><span style=display:flex><span><span style=color:#66d9ef>INTO</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>table</span> [<span style=color:#66d9ef>IN</span> externaldb]
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> oldtable
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> condition;
</span></span></code></pre></div><h2 id=insert-into-select>INSERT INTO SELECT<a hidden class=anchor aria-hidden=true href=#insert-into-select>#</a></h2><ul><li>The <code>INSERT INTO SELECT</code> statement copies data from one table and inserts it into another table.</li><li>The <code>INSERT INTO SELECT</code> statement requires that the data types in source and target tables match.</li></ul><blockquote><p><em>Note:</em> The existing records in the target table are unaffected.</p></blockquote><ul><li><strong>Copy all columns from one table to another table:</strong></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> table2
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#f92672>*</span> <span style=color:#66d9ef>FROM</span> table1
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> condition
</span></span></code></pre></div><ul><li><strong>Copy only some columns from one table into another table:</strong></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> table2 (column1, column2, column3, ...)
</span></span><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> column1, column2, column3, ...
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> table1
</span></span><span style=display:flex><span><span style=color:#66d9ef>WHERE</span> condition
</span></span></code></pre></div><h2 id=case>CASE<a hidden class=anchor aria-hidden=true href=#case>#</a></h2><ul><li>The <code>CASE</code> expression goes through conditions and returns a value when the first condition is met (like an if-then-else statement). So, once a condition is true, it will stop reading and return the result. If no conditions are true, it returns the value in the <code>ELSE</code> cluase.</li><li>If there is no <code>ELSE</code> part and no condtions are true, it retures NULL.</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>CASE</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>WHEN</span> conditon1 <span style=color:#66d9ef>THEN</span> result1
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>WHEN</span> conditon2 <span style=color:#66d9ef>THEN</span> result2
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>WHEN</span> conditonN <span style=color:#66d9ef>THEN</span> resultN
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>ELSE</span> resuklt
</span></span><span style=display:flex><span><span style=color:#66d9ef>END</span>
</span></span></code></pre></div><h2 id=null-functions>NULL Functions<a hidden class=anchor aria-hidden=true href=#null-functions>#</a></h2><p><strong>Products</strong>
|P_Id|ProductName|UnitPrice|UnitsInStock|UnitsOnOrder|
|1|Jarlsberg|10.45|16|15|
|2|Mascarpone|32.56|23| |
|3|Gorgonzola|15.67|9|20|</p><ul><li><p>Suppose that the &ldquo;UnitsOnOrder&rdquo; column is optional, and may contain NULL values.</p></li><li><p><strong>MySQL</strong></p></li></ul><ol><li><code>INFULL()</code></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> ProductName, UnitPrice <span style=color:#f92672>*</span> (UnitsInStock <span style=color:#f92672>+</span> 
</span></span><span style=display:flex><span>IFNULL(UnitsOnOrder, <span style=color:#ae81ff>0</span>))
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> Products;
</span></span></code></pre></div><ol start=2><li><code>COALESCE()</code></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> ProductName, UnitPrice <span style=color:#f92672>*</span> (UnitsInStock <span style=color:#f92672>+</span> 
</span></span><span style=display:flex><span>COALESCE(UnitsOnOrder, <span style=color:#ae81ff>0</span>))
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> Products;
</span></span></code></pre></div><ul><li><strong>SQL Server</strong></li></ul><ol><li><code>ISNULL()</code></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> ProductName, UnitPrice <span style=color:#f92672>*</span> (UnitsInStock <span style=color:#f92672>+</span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>ISNULL</span>(UnitsOnOrder, <span style=color:#ae81ff>0</span>))
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> Products;
</span></span></code></pre></div><ol start=2><li><code>COALESCE()</code></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> ProductName, UnitPrice <span style=color:#f92672>*</span> (UnitsInStock <span style=color:#f92672>+</span> 
</span></span><span style=display:flex><span>COALESCE(UnitsOnOrder, <span style=color:#ae81ff>0</span>))
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> Products;
</span></span></code></pre></div><ul><li><strong>MS Access</strong></li></ul><ol><li><code>IsNULL()</code></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> ProductName, UnitPrice <span style=color:#f92672>*</span> (UnitsInStock <span style=color:#f92672>+</span> 
</span></span><span style=display:flex><span>IIF(<span style=color:#66d9ef>IsNull</span>(UnitsOnOrder), <span style=color:#ae81ff>0</span>, UnitsOnOrder))
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> Products;
</span></span></code></pre></div><ul><li><strong>Oracle</strong></li></ul><ol><li><code>NVL()</code></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> ProductName, UnitPrice <span style=color:#f92672>*</span> (UnitsInStock <span style=color:#f92672>+</span> 
</span></span><span style=display:flex><span>NVL(UnitsOnOrder, <span style=color:#ae81ff>0</span>))
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> Products;
</span></span></code></pre></div><ol start=2><li><code>COALESCE()</code></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> <span style=color:#66d9ef>SELECT</span> ProductName, UnitPrice <span style=color:#f92672>*</span> (UnitsInStock <span style=color:#f92672>+</span>
</span></span><span style=display:flex><span>COALESCE(UnitsOnOrder, <span style=color:#ae81ff>0</span>))
</span></span><span style=display:flex><span><span style=color:#66d9ef>FROM</span> Products;
</span></span></code></pre></div><h2 id=sotred-precedures>Sotred Precedures<a hidden class=anchor aria-hidden=true href=#sotred-precedures>#</a></h2><ul><li><p>A stored procedure is a prepared SQL code that you can save, so the code can be reused over and over again.</p></li><li><p>So if you have an SQL query that you write over and over again, save it as a stored procedure, and then just call it to execute it.</p></li><li><p>You can also pass parameters to a stored procedure, so that the stored procedure can act based on the parameter value(s) that is passed.</p></li></ul><p><strong>Stored Procedure Syntax</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>CREATE</span> <span style=color:#66d9ef>PROCEDURE</span> procedure_name
</span></span><span style=display:flex><span><span style=color:#66d9ef>AS</span>
</span></span><span style=display:flex><span>sql_statement
</span></span><span style=display:flex><span><span style=color:#66d9ef>GO</span>;
</span></span></code></pre></div><p>** Execute as Stored Procedure</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>EXEC</span> procedure_name;
</span></span></code></pre></div><h2 id=comments>Comments<a hidden class=anchor aria-hidden=true href=#comments>#</a></h2><ul><li>Single line comments <code>--</code>.</li><li>Multi-line comments <code>/*</code> and <code>*/</code>.</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://intervalrain.github.io/tags/sql/>SQL</a></li><li><a href=https://intervalrain.github.io/tags/it/>IT</a></li></ul></footer><script src=https://utteranc.es/client.js repo=Reid00/hugo-blog-talks issue-term=pathname label=Comment theme=github-light crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2025 <a href=https://intervalrain.github.io/>Rain Hu's Workspace</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="複製";function s(){t.innerHTML="已複製！",setTimeout(()=>{t.innerHTML="複製"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>