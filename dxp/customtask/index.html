<!doctype html><html lang=zh-tw dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[DXP] 在 spotfire 中創建自定義任務 | Rain Hu's Workspace</title><meta name=keywords content="spotfire,dxp,task"><meta name=description content="在 spotfire 中創建自定義任務"><meta name=author content="Rain Hu"><link rel=canonical href=https://intervalrain.github.io/><meta name=google-site-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.0cefe5a1d95e3d0f0cce057d37c60cd238d1a4af825090f831a18f21671f621d.css integrity="sha256-DO/lodlePQ8MzgV9N8YM0jjRpK+CUJD4MaGPIWcfYh0=" rel="preload stylesheet" as=style><link rel=icon href=https://intervalrain.github.io/images/rain.png><link rel=icon type=image/png sizes=16x16 href=https://intervalrain.github.io/images/rain.png><link rel=icon type=image/png sizes=32x32 href=https://intervalrain.github.io/images/rain.png><link rel=apple-touch-icon href=https://intervalrain.github.io/images/rain.png><link rel=mask-icon href=https://intervalrain.github.io/images/rain.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh-tw href=https://intervalrain.github.io/dxp/customtask/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css integrity=sha384-zTROYFVGOfTw7JV7KUu8udsvW2fx4lWOsCEDqhBreBwlHI4ioVRtmIvEThzJHGET crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.js integrity=sha384-GxNFqL3r9uRJQhR+47eDxuPoNE7yLftQM8LcxzgS4HT73tp970WS/wV5p8UzCOmb crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous onload=renderMathInElement(document.body)></script><script async src=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js></script><script src=https://utteranc.es/client.js repo=intervalrain.github.io issue-term=pathname label=Comment theme=github-light crossorigin=anonymous async></script><meta property="og:url" content="https://intervalrain.github.io/dxp/customtask/"><meta property="og:site_name" content="Rain Hu's Workspace"><meta property="og:title" content="[DXP] 在 spotfire 中創建自定義任務"><meta property="og:description" content="在 spotfire 中創建自定義任務"><meta property="og:locale" content="zh-tw"><meta property="og:type" content="article"><meta property="article:section" content="dxp"><meta property="article:published_time" content="2023-06-06T21:36:12+08:00"><meta property="article:modified_time" content="2023-06-06T21:36:12+08:00"><meta property="article:tag" content="Spotfire"><meta property="article:tag" content="Dxp"><meta name=twitter:card content="summary"><meta name=twitter:title content="[DXP] 在 spotfire 中創建自定義任務"><meta name=twitter:description content="在 spotfire 中創建自定義任務"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Dxps","item":"https://intervalrain.github.io/dxp/"},{"@type":"ListItem","position":2,"name":"[DXP] 在 spotfire 中創建自定義任務","item":"https://intervalrain.github.io/dxp/customtask/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[DXP] 在 spotfire 中創建自定義任務","name":"[DXP] 在 spotfire 中創建自定義任務","description":"在 spotfire 中創建自定義任務","keywords":["spotfire","dxp","task"],"articleBody":"簡介 Spotfire Automation Services 提供一個平台和工具，用於在無使用者操作與 UI 的情況下自動地執行 TIBCO Spotfire。 適用情境如「定期發送報告」、「在某些事件發生時保存嵌入在 Spotfire 文件中的截圖」，以及在許多其他需要基於Spotfire文件進行自動化操作的情況下使用。 自動化服務 API 使自訂任務變得可能，且可與內建任務一起使用，執行自動化工作。 Spotfire 用語 名詞 解釋 Task Task 是用於創建複雜工作的基礎模塊。自動化服務附帶了許多預定義的 Tasks，例如應用書籤或發送電子郵件或乃至其它可擴充的 Tasks。 Job 排程好待執行的 Tasks 組合成一個 Job，Job 又被儲存於 Job File 中。 Job File Job File 是一個可讀的 XML，用於定義 Job。 Job Builder Job Builder 是一個在 Spotfire 專業版中運行的應用程式，提供了一個易於使用的界面，用於創建和編輯工作。 Job Sender ClientJobSender 是一個工具，可將作業發送到 Spotfire Server 以進行執行。使用 ClientJobSender 設置定期或事件驅動的作業執行。 架構 Job 通常是在 Job Builder 或 ClientJobSender 中創建並保存為 XML 的 Job File，然後被送至 Spotfire 伺服器以執行，或是使用 ClientJobSender 工具發送到 Spotfire 伺服器以進行執行。 對於每個以 XML 格式發送到 Spotfire Server 以執行的工作，Automation Services 會啟動一個 node。接著內部工作執行程序會逐一執行任務，直到任務失敗或所有任務成功完成時退出。 Job File 格式 工作檔案的 XML 格式設計為易於理解和修改。雖沒有正式的格式規範，但可讀性仍是挺高的。 以下是一個「從 Analytics Server Library 開啟分析文件並將圖像匯出到預定位置」的 Job 範例： ","wordCount":"289","inLanguage":"zh-tw","datePublished":"2023-06-06T21:36:12+08:00","dateModified":"2023-06-06T21:36:12+08:00","author":{"@type":"Person","name":"Rain Hu"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://intervalrain.github.io/dxp/customtask/"},"publisher":{"@type":"Organization","name":"Rain Hu's Workspace","logo":{"@type":"ImageObject","url":"https://intervalrain.github.io/images/rain.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://intervalrain.github.io/ accesskey=h title="Rain Hu's Workspace (Alt + H)"><img src=https://intervalrain.github.io/images/rain.png alt aria-label=logo height=35>Rain Hu's Workspace</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://intervalrain.github.io/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://intervalrain.github.io/aboutme title="About me"><span>About me</span></a></li><li><a href=https://intervalrain.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://intervalrain.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://intervalrain.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://intervalrain.github.io/csharp/csharp title=C#><span>C#</span></a></li><li><a href=https://intervalrain.github.io/csindex title=CS><span>CS</span></a></li><li><a href=https://intervalrain.github.io/leetcode title=LeetCode><span>LeetCode</span></a></li><li><a href=https://intervalrain.github.io/ai title=AI><span>AI</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://intervalrain.github.io/>首頁</a>&nbsp;»&nbsp;<a href=https://intervalrain.github.io/dxp/>Dxps</a></div><h1 class="post-title entry-hint-parent">[DXP] 在 spotfire 中創建自定義任務</h1><div class=post-description>在 spotfire 中創建自定義任務</div><div class=post-meta><span title='2023-06-06 21:36:12 +0800 +0800'>June 6, 2023</span>&nbsp;·&nbsp;2 分鐘&nbsp;·&nbsp;Rain Hu&nbsp;|&nbsp;<a href=https://github.com/intervalrain/intervalrain.github.io/tree/main/content//dxp/customTask.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目錄</span></summary><div class=inner><ul><li><a href=#%e7%b0%a1%e4%bb%8b aria-label=簡介>簡介</a></li><li><a href=#spotfire-%e7%94%a8%e8%aa%9e aria-label="Spotfire 用語">Spotfire 用語</a></li><li><a href=#%e6%9e%b6%e6%a7%8b aria-label=架構>架構</a></li><li><a href=#job-file-%e6%a0%bc%e5%bc%8f aria-label="Job File 格式">Job File 格式</a></li><li><a href=#%e8%87%aa%e5%8b%95%e5%8c%96-task-%e7%af%84%e4%be%8b aria-label="自動化 Task 範例">自動化 Task 範例</a></li><li><a href=#%e8%a8%bb%e5%86%8a aria-label=註冊>註冊</a></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h3 id=簡介>簡介<a hidden class=anchor aria-hidden=true href=#簡介>#</a></h3><ul><li>Spotfire Automation Services 提供一個平台和工具，用於在無使用者操作與 UI 的情況下自動地執行 TIBCO Spotfire。</li><li>適用情境如「定期發送報告」、「在某些事件發生時保存嵌入在 Spotfire 文件中的截圖」，以及在許多其他需要基於Spotfire文件進行自動化操作的情況下使用。</li><li>自動化服務 API 使自訂任務變得可能，且可與內建任務一起使用，執行自動化工作。</li></ul><h3 id=spotfire-用語>Spotfire 用語<a hidden class=anchor aria-hidden=true href=#spotfire-用語>#</a></h3><table><thead><tr><th>名詞</th><th>解釋</th></tr></thead><tbody><tr><td>Task</td><td>Task 是用於創建複雜工作的基礎模塊。自動化服務附帶了許多預定義的 Tasks，例如應用書籤或發送電子郵件或乃至其它可擴充的 Tasks。</td></tr><tr><td>Job</td><td>排程好待執行的 Tasks 組合成一個 Job，Job 又被儲存於 Job File 中。</td></tr><tr><td>Job File</td><td>Job File 是一個可讀的 XML，用於定義 Job。</td></tr><tr><td>Job Builder</td><td>Job Builder 是一個在 Spotfire 專業版中運行的應用程式，提供了一個易於使用的界面，用於創建和編輯工作。</td></tr><tr><td>Job Sender</td><td>ClientJobSender 是一個工具，可將作業發送到 Spotfire Server 以進行執行。使用 ClientJobSender 設置定期或事件驅動的作業執行。</td></tr></tbody></table><h3 id=架構>架構<a hidden class=anchor aria-hidden=true href=#架構>#</a></h3><p><img alt=pic1 loading=lazy src=https://supportinfo.tibco.com/stca/comm/Create-an-Automation-Services-Custom-Task-in-TIBCO-Spotfire-1.png></p><ul><li>Job 通常是在 Job Builder 或 ClientJobSender 中創建並保存為 XML 的 Job File，然後被送至 Spotfire 伺服器以執行，或是使用 ClientJobSender 工具發送到 Spotfire 伺服器以進行執行。</li><li>對於每個以 XML 格式發送到 Spotfire Server 以執行的工作，Automation Services 會啟動一個 <strong>node</strong>。接著內部工作執行程序會逐一執行任務，直到任務失敗或所有任務成功完成時退出。</li></ul><h3 id=job-file-格式>Job File 格式<a hidden class=anchor aria-hidden=true href=#job-file-格式>#</a></h3><ul><li>工作檔案的 XML 格式設計為易於理解和修改。雖沒有正式的格式規範，但可讀性仍是挺高的。</li><li>以下是一個「從 Analytics Server Library 開啟分析文件並將圖像匯出到預定位置」的 Job 範例：</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;as:Job</span> <span style=color:#a6e22e>xmlns:as=</span><span style=color:#e6db74>&#34;urn:tibco:spotfire.dxp.automation&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;as:Tasks&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;OpenAnalysisFromLibrary</span> <span style=color:#a6e22e>xmlns=</span><span style=color:#e6db74>&#34;urn:tibco:spotfire.dxp.automation.tasks&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;as:Title&gt;</span>Open Analysis from Library<span style=color:#f92672>&lt;/as:Title&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;AnalysisPath&gt;</span>/Users/Username/Baseball stats<span style=color:#f92672>&lt;/AnalysisPath&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/OpenAnalysisFromLibrary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;ExportImage</span> <span style=color:#a6e22e>xmlns=</span><span style=color:#e6db74>&#34;urn:tibco:spotfire.dxp.automation.tasks&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;as:Title&gt;</span>Export Image<span style=color:#f92672>&lt;/as:Title&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;VisualizationId&gt;</span>292a90c6-0e03-47fe-961e-a528a14e9735<span style=color:#f92672>&lt;/VisualizationId&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;DestinationPath&gt;</span>C:inetpubwwwrootMyWebServerImage.png<span style=color:#f92672>&lt;/DestinationPath&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;Width&gt;</span>640<span style=color:#f92672>&lt;/Width&gt;</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>&lt;Height&gt;</span>480<span style=color:#f92672>&lt;/Height&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/ExportImage&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/as:Tasks&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/as:Job&gt;</span>
</span></span></code></pre></div><h3 id=自動化-task-範例>自動化 Task 範例<a hidden class=anchor aria-hidden=true href=#自動化-task-範例>#</a></h3><ul><li>一個 Task 需繼承 <code>Task</code> 母類別。</li><li>一個 <code>Task</code> 類別必須擁有一個無參建構式，並呼叫 base 建構式，並傳入標題和描述。如果相同的任務名稱已經在使用中，可以選擇性地使用 XmlRoot 命名空間來避免命名衝突。為自訂任務使用自訂命名空間。</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#75715e>// 自定義任務的命名空間</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>[XmlRoot(&#34;urn:spotfiredeveloper.automationservicesexample&#34;)]</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>sealed</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>ApplyBookmark</span> : Task
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 建立一個無參建構式，並呼叫 base 建構式，同時傳入標題與描述</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> ApplyBookmark()
</span></span><span style=display:flex><span>        : <span style=color:#66d9ef>base</span>(Properties.Resources.ApplyBookmarkTitle, Properties.Resources.ApplyBookmarkDescription)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 一些 public 的 properties 可供 UI 存取</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>    [Description(&#34;The GUID of the bookmark to apply&#34;)]</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> Guid BookmarkId { <span style=color:#66d9ef>get</span>; <span style=color:#66d9ef>set</span>; }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li>當任務被執行時，會執行 <code>ExecuteCore</code> 方法。</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C# data-lang=C#><span style=display:flex><span><span style=color:#66d9ef>protected</span> <span style=color:#66d9ef>override</span> TaskExecutionStatus ExecuteCore(TaskExecutionContext context)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 沒有文件被讀取</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (context.Application.Document == <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> TaskExecutionStatus(<span style=color:#66d9ef>false</span>, Properties.Resources.NoAnalysisLoaded);
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 檢查書籤是否存在於新書籤中</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>var</span> manager = context.Application.GetService&lt;BookmarkManager&gt;();
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (manager != <span style=color:#66d9ef>null</span>)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        Bookmark bookmark;
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (manager.TryGetBookmark(<span style=color:#66d9ef>this</span>.BookmarkId, <span style=color:#66d9ef>out</span> bookmark))
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 套用書籤</span>
</span></span><span style=display:flex><span>            manager.Apply(bookmark);
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> TaskExecutionStatus(<span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 檢查書籤是否存在於舊書籤中</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>foreach</span> (<span style=color:#66d9ef>var</span> bookmark <span style=color:#66d9ef>in</span> context.Application.Document.Bookmarks)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> (bookmark.Id == <span style=color:#66d9ef>this</span>.BookmarkId)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#75715e>// 套用書籤</span>
</span></span><span style=display:flex><span>            bookmark.Apply();
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> TaskExecutionStatus(<span style=color:#66d9ef>true</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 找不到書籤，報錯</span>
</span></span><span style=display:flex><span>    Console.WriteLine(<span style=color:#e6db74>&#34;Error in execution of job {0}. The bookmark {1} was not found.&#34;</span>, context.Id, <span style=color:#66d9ef>this</span>.BookmarkId);
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> TaskExecutionStatus(<span style=color:#66d9ef>false</span>, Common.Format(Properties.Resources.BookmarkNotAvaliable, <span style=color:#66d9ef>this</span>.BookmarkId));
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=註冊>註冊<a hidden class=anchor aria-hidden=true href=#註冊>#</a></h3><ul><li>最後，工作任務必須被註冊在單獨的 <code>RegisterTasksAddin</code> 類別中</li></ul><pre tabindex=0><code>public sealed class TasksAddIn : RegisterTasksAddIn
{
    public override void RegisterTasks(TaskRegistrar registrar)
    {
        registrar.Register(new ApplyBookmark());
    }
}
</code></pre></div><footer class=post-footer><ul class=post-tags><li><a href=https://intervalrain.github.io/tags/spotfire/>Spotfire</a></li><li><a href=https://intervalrain.github.io/tags/dxp/>Dxp</a></li></ul><script type=module>  
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs'; 
    mermaid.initialize({ startOnLoad: true });  
</script><script>Array.from(document.getElementsByClassName("language-mermaid")).forEach(e=>{e.parentElement.outerHTML=`<div class="mermaid">${e.innerHTML}</div>`})</script><style>.mermaid svg{display:block;margin:auto}</style></footer><script src=https://utteranc.es/client.js repo=Reid00/hugo-blog-talks issue-term=pathname label=Comment theme=github-light crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2025 <a href=https://intervalrain.github.io/>Rain Hu's Workspace</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="複製";function s(){t.innerHTML="已複製！",setTimeout(()=>{t.innerHTML="複製"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>