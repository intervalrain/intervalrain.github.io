<!doctype html><html lang=zh-tw dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>[DXP] Spotfire Extension 擴充程式 | Rain Hu's Workspace</title>
<meta name=keywords content="spotfire,dxp,extension,擴充"><meta name=description content="spotfire sdk 介紹"><meta name=author content="Rain Hu"><link rel=canonical href=https://intervalrain.github.io/><meta name=google-site-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.662816b9df27c772d2b97c5f5f6bf4f2c5531051a330015f0ad4135736d0e56a.css integrity="sha256-ZigWud8nx3LSuXxfX2v08sVTEFGjMAFfCtQTVzbQ5Wo=" rel="preload stylesheet" as=style><link rel=icon href=https://intervalrain.github.io/images/rain.png><link rel=icon type=image/png sizes=16x16 href=https://intervalrain.github.io/images/rain.png><link rel=icon type=image/png sizes=32x32 href=https://intervalrain.github.io/images/rain.png><link rel=apple-touch-icon href=https://intervalrain.github.io/images/rain.png><link rel=mask-icon href=https://intervalrain.github.io/images/rain.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh-tw href=https://intervalrain.github.io/dxp/extension/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.css integrity=sha384-zTROYFVGOfTw7JV7KUu8udsvW2fx4lWOsCEDqhBreBwlHI4ioVRtmIvEThzJHGET crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/katex.min.js integrity=sha384-GxNFqL3r9uRJQhR+47eDxuPoNE7yLftQM8LcxzgS4HT73tp970WS/wV5p8UzCOmb crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.18/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous onload=renderMathInElement(document.body)></script><script async src=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js></script><script src=https://utteranc.es/client.js repo=intervalrain.github.io issue-term=pathname label=Comment theme=github-light crossorigin=anonymous async></script><meta property="og:url" content="https://intervalrain.github.io/dxp/extension/"><meta property="og:site_name" content="Rain Hu's Workspace"><meta property="og:title" content="[DXP] Spotfire Extension 擴充程式"><meta property="og:description" content="spotfire sdk 介紹"><meta property="og:locale" content="zh-tw"><meta property="og:type" content="article"><meta property="article:section" content="dxp"><meta property="article:published_time" content="2023-06-23T03:03:52+08:00"><meta property="article:modified_time" content="2023-06-23T03:03:52+08:00"><meta property="article:tag" content="Spotfire"><meta property="article:tag" content="Dxp"><meta name=twitter:card content="summary"><meta name=twitter:title content="[DXP] Spotfire Extension 擴充程式"><meta name=twitter:description content="spotfire sdk 介紹"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Dxps","item":"https://intervalrain.github.io/dxp/"},{"@type":"ListItem","position":2,"name":"[DXP] Spotfire Extension 擴充程式","item":"https://intervalrain.github.io/dxp/extension/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"[DXP] Spotfire Extension 擴充程式","name":"[DXP] Spotfire Extension 擴充程式","description":"spotfire sdk 介紹","keywords":["spotfire","dxp","extension","擴充"],"articleBody":"Spotfire Extension Spotfire Extension 是添加到平台的最小功能單元。它是在 Visual Studio® 中開發的，並包含在 Spotfire 外掛中，使版本控制、授權、部署和加載成為可能。本主題描述了開發 Extension 時需要的關鍵概念，以添加自定義功能到 Spotfire 平台。\nAdd-in Extensions 以 add-in 的方式載入 Spotifre 中。Spotfire 處理版本控制、部署及為擴充功能註冊。Spotfire extension 的設計燈南規定每個 add-in 都必須包含一個繼承 AddIn Class 的類別。Add-in 基本上是由在從 SDK 模板創建專案時提供的資訊所定義的。Add-in project 可以包含一或多個 extensions，故專案也可以輕鬆的透過添加其它擴充來建立新的版本。 每個擴充功能都是由一組類別實現的，通常是透過 override base class 來定義擴充類別，並透過覆寫特定擴充類別的方法 Register[ExtensionType]()，宣告式地進行 add-in 的註冊。每個這樣的方法都會傳遞一個 registrar，允許 add-in 在適當的 registry 進行註冊。例如在註冊新的工具(tool)時，必須要 override 方法 RegisterTools(ToolRegister)。在授權擴充功能時也會使用類似的方法。 如果一個模組有有效的模組定義檔案，則被定義為適合在 Spotfire 中載入。它通過定義 AddIn 類別的完全限定類型名稱和組件名稱來向應用程式聲明這個外掛程式。它還聲明了一個唯一的專案GUID和 assembly 的強名稱(string name)。這些組合唯一地識別了專案和外掛程式。因此，Extension assembly 必須使用強名稱金鑰(string name key)文件（.snk）簽名。擴展專案模板包含一個默認金鑰。可以用自己的金鑰文件替換此金鑰文件，但如果這樣做，請務必相應地修改模組定義檔案。 Extesnion Type IronPython 提供一種輕量的方式，便可在分析本身中添加複雜的行為，無需透過開發工具與部署機制，便可快速的創建小型的應用程序。而當需要創建自定義的功能時，就需要用到 C# 的擴充機制。 Custom Tool Custom Tool 用於擴充在 Spotfire 中特定文本(context) 上的操作。文本可以是 Spotfire 應用程式(application)本身、檔案庫(document)、或是每個特定的可視化類型(visualization)。 包含 Custom Tool、Custom Export Tool、Custom Share Tool Custom Panel Custom Panel 是通用 UI 組件，用於視覺化文本資訊、添加控制項或其它特定的功能。 Custom Visualization Custom Visualization 可用來擴充 Spotfire 的 Visualization Set，使之可以從 Visualization 選單中、繪圖文本(plot context)清單上、工具列中被選擇，並與其它繪圖工具一樣享有數據集、標記(marking)、與篩選(filtering )功能。 Custom Value Renderer Custom Value Renderer 用來呈現表格視覺化列中的值。最常見的情況是將數據值轉成圖像，在表格中呈現。 Custom Data Source Custom Data Source 用來匯入任何自訂的外部資料來源。 Custom Data Function Custom Data Function 用自定義的公式將文件中的資料進行計算後輸出到文件的其它位置。 Custom Data Tranformation Custom Data Transformation 在資料讀取和建立表格之間添加了一層，提供在匯入資料前修改資料的方法。資料轉換將一個規則或函數應用於檢索到的資料，以準備進行分析。 Custom Data Writer Custom Data Writer 用於匯出自定義格式的檔案。 Custom Expression Functions Custom Expression Functions 可以擴展在自定義表達式和計算列中使用的表達式語言。可以是基於行、列或聚合方法。 Custom Fitting Model Custom Fitting Model 由 Visualization 的座標和參數計算出值，以繪值對應的參考點或曲線。 Custom Virtual Column Custom Virtual Column 根據一個或多個現有的列和文件屬性創建新的欄。 Custom Preference Custom Preference 偏好設定，也稱作 Configuration Sets。 Custom License Custom License 可用於自訂授權。 Custom Node Custom Node 可以添加項目到 spotfire document model 中，並序列化到 dxp 文件中。 Custom Application Event Handler Custom Application Event Handler 可用來監控並回應應用程式事件。 ","wordCount":"196","inLanguage":"zh-tw","datePublished":"2023-06-23T03:03:52+08:00","dateModified":"2023-06-23T03:03:52+08:00","author":{"@type":"Person","name":"Rain Hu"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://intervalrain.github.io/dxp/extension/"},"publisher":{"@type":"Organization","name":"Rain Hu's Workspace","logo":{"@type":"ImageObject","url":"https://intervalrain.github.io/images/rain.png"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://intervalrain.github.io/ accesskey=h title="Rain Hu's Workspace (Alt + H)"><img src=https://intervalrain.github.io/images/rain.png alt aria-label=logo height=35>Rain Hu's Workspace</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://intervalrain.github.io/search title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://intervalrain.github.io/aboutme title="About me"><span>About me</span></a></li><li><a href=https://intervalrain.github.io/archives title=Archives><span>Archives</span></a></li><li><a href=https://intervalrain.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://intervalrain.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://intervalrain.github.io/csharp/csharp title=C#><span>C#</span></a></li><li><a href=https://intervalrain.github.io/csindex title=CS><span>CS</span></a></li><li><a href=https://intervalrain.github.io/leetcode title=LeetCode><span>LeetCode</span></a></li><li><a href=https://intervalrain.github.io/ai title=AI><span>AI</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://intervalrain.github.io/>首頁</a>&nbsp;»&nbsp;<a href=https://intervalrain.github.io/dxp/>Dxps</a></div><h1 class="post-title entry-hint-parent">[DXP] Spotfire Extension 擴充程式</h1><div class=post-description>spotfire sdk 介紹</div><div class=post-meta><span title='2023-06-23 03:03:52 +0800 +0800'>June 23, 2023</span>&nbsp;·&nbsp;1 分鐘&nbsp;·&nbsp;Rain Hu&nbsp;|&nbsp;<a href=https://github.com/intervalrain/intervalrain.github.io/tree/main/content//dxp/extension.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><aside id=toc-container class="toc-container wide"><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>目錄</span></summary><div class=inner><ul><li><a href=#spotfire-extension aria-label="Spotfire Extension">Spotfire Extension</a><ul><li><a href=#add-in aria-label=Add-in>Add-in</a></li><li><a href=#extesnion-type aria-label="Extesnion Type">Extesnion Type</a><ul><li><a href=#custom-tool aria-label="Custom Tool">Custom Tool</a></li><li><a href=#custom-panel aria-label="Custom Panel">Custom Panel</a></li><li><a href=#custom-visualization aria-label="Custom Visualization">Custom Visualization</a></li><li><a href=#custom-value-renderer aria-label="Custom Value Renderer">Custom Value Renderer</a></li><li><a href=#custom-data-source aria-label="Custom Data Source">Custom Data Source</a></li><li><a href=#custom-data-function aria-label="Custom Data Function">Custom Data Function</a></li><li><a href=#custom-data-tranformation aria-label="Custom Data Tranformation">Custom Data Tranformation</a></li><li><a href=#custom-data-writer aria-label="Custom Data Writer">Custom Data Writer</a></li><li><a href=#custom-expression-functions aria-label="Custom Expression Functions">Custom Expression Functions</a></li><li><a href=#custom-fitting-model aria-label="Custom Fitting Model">Custom Fitting Model</a></li><li><a href=#custom-virtual-column aria-label="Custom Virtual Column">Custom Virtual Column</a></li><li><a href=#custom-preference aria-label="Custom Preference">Custom Preference</a></li><li><a href=#custom-license aria-label="Custom License">Custom License</a></li><li><a href=#custom-node aria-label="Custom Node">Custom Node</a></li><li><a href=#custom-application-event-handler aria-label="Custom Application Event Handler">Custom Application Event Handler</a></li></ul></li></ul></li></ul></div></details></div></aside><script>let activeElement,elements;window.addEventListener("DOMContentLoaded",function(){checkTocPosition(),elements=document.querySelectorAll("h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]"),activeElement=elements[0];const t=encodeURI(activeElement.getAttribute("id")).toLowerCase();document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active")},!1),window.addEventListener("resize",function(){checkTocPosition()},!1),window.addEventListener("scroll",()=>{activeElement=Array.from(elements).find(e=>{if(getOffsetTop(e)-window.pageYOffset>0&&getOffsetTop(e)-window.pageYOffset<window.innerHeight/2)return e})||activeElement,elements.forEach(e=>{const t=encodeURI(e.getAttribute("id")).toLowerCase();e===activeElement?document.querySelector(`.inner ul li a[href="#${t}"]`).classList.add("active"):document.querySelector(`.inner ul li a[href="#${t}"]`).classList.remove("active")})},!1);const main=parseInt(getComputedStyle(document.body).getPropertyValue("--article-width"),10),toc=parseInt(getComputedStyle(document.body).getPropertyValue("--toc-width"),10),gap=parseInt(getComputedStyle(document.body).getPropertyValue("--gap"),10);function checkTocPosition(){const e=document.body.scrollWidth;e-main-toc*2-gap*4>0?document.getElementById("toc-container").classList.add("wide"):document.getElementById("toc-container").classList.remove("wide")}function getOffsetTop(e){if(!e.getClientRects().length)return 0;let t=e.getBoundingClientRect(),n=e.ownerDocument.defaultView;return t.top+n.pageYOffset}</script><div class=post-content><h1 id=spotfire-extension>Spotfire Extension<a hidden class=anchor aria-hidden=true href=#spotfire-extension>#</a></h1><blockquote><p>Spotfire Extension 是添加到平台的最小功能單元。它是在 Visual Studio® 中開發的，並包含在 Spotfire 外掛中，使版本控制、授權、部署和加載成為可能。本主題描述了開發 Extension 時需要的關鍵概念，以添加自定義功能到 Spotfire 平台。</p></blockquote><h2 id=add-in>Add-in<a hidden class=anchor aria-hidden=true href=#add-in>#</a></h2><ul><li>Extensions 以 <code>add-in</code> 的方式載入 Spotifre 中。Spotfire 處理版本控制、部署及為擴充功能註冊。Spotfire extension 的設計燈南規定每個 add-in 都必須包含一個繼承 <code>AddIn Class</code> 的類別。Add-in 基本上是由在從 SDK 模板創建專案時提供的資訊所定義的。Add-in project 可以包含一或多個 extensions，故專案也可以輕鬆的透過添加其它擴充來建立新的版本。</li><li>每個擴充功能都是由一組類別實現的，通常是透過 <code>override base class</code> 來定義擴充類別，並透過覆寫特定擴充類別的方法 <code>Register[ExtensionType]()</code>，宣告式地進行 add-in 的註冊。每個這樣的方法都會傳遞一個 registrar，允許 add-in 在適當的 registry 進行註冊。例如在註冊新的工具(tool)時，必須要 override 方法 <code>RegisterTools(ToolRegister)</code>。在授權擴充功能時也會使用類似的方法。</li><li>如果一個模組有有效的模組定義檔案，則被定義為適合在 Spotfire 中載入。它通過定義 <code>AddIn</code> 類別的完全限定類型名稱和組件名稱來向應用程式聲明這個外掛程式。它還聲明了一個唯一的專案GUID和 assembly 的強名稱(string name)。這些組合唯一地識別了專案和外掛程式。因此，Extension assembly 必須使用強名稱金鑰(string name key)文件（.snk）簽名。擴展專案模板包含一個默認金鑰。可以用自己的金鑰文件替換此金鑰文件，但如果這樣做，請務必相應地修改模組定義檔案。</li></ul><h2 id=extesnion-type>Extesnion Type<a hidden class=anchor aria-hidden=true href=#extesnion-type>#</a></h2><ul><li>IronPython 提供一種輕量的方式，便可在分析本身中添加複雜的行為，無需透過開發工具與部署機制，便可快速的創建小型的應用程序。而當需要創建自定義的功能時，就需要用到 C# 的擴充機制。
<img alt="extension type" loading=lazy src=https://supportinfo.tibco.com/stca/comm/How-to-choose-between-using-IronPython-scripting-and-creating-a-C-Extension-when-developing-for-TIBCO-Spotfire-3.png></li></ul><h3 id=custom-tool>Custom Tool<a hidden class=anchor aria-hidden=true href=#custom-tool>#</a></h3><ul><li>Custom Tool 用於擴充在 Spotfire 中特定文本(context) 上的操作。文本可以是 Spotfire 應用程式(application)本身、檔案庫(document)、或是每個特定的可視化類型(visualization)。</li><li>包含 <code>Custom Tool</code>、<code>Custom Export Tool</code>、<code>Custom Share Tool</code></li></ul><h3 id=custom-panel>Custom Panel<a hidden class=anchor aria-hidden=true href=#custom-panel>#</a></h3><ul><li>Custom Panel 是通用 UI 組件，用於視覺化文本資訊、添加控制項或其它特定的功能。</li></ul><h3 id=custom-visualization>Custom Visualization<a hidden class=anchor aria-hidden=true href=#custom-visualization>#</a></h3><ul><li>Custom Visualization 可用來擴充 Spotfire 的 Visualization Set，使之可以從 Visualization 選單中、繪圖文本(plot context)清單上、工具列中被選擇，並與其它繪圖工具一樣享有數據集、標記(marking)、與篩選(filtering )功能。</li></ul><h3 id=custom-value-renderer>Custom Value Renderer<a hidden class=anchor aria-hidden=true href=#custom-value-renderer>#</a></h3><ul><li>Custom Value Renderer 用來呈現表格視覺化列中的值。最常見的情況是將數據值轉成圖像，在表格中呈現。</li></ul><h3 id=custom-data-source>Custom Data Source<a hidden class=anchor aria-hidden=true href=#custom-data-source>#</a></h3><ul><li>Custom Data Source 用來匯入任何自訂的外部資料來源。</li></ul><h3 id=custom-data-function>Custom Data Function<a hidden class=anchor aria-hidden=true href=#custom-data-function>#</a></h3><ul><li>Custom Data Function 用自定義的公式將文件中的資料進行計算後輸出到文件的其它位置。</li></ul><h3 id=custom-data-tranformation>Custom Data Tranformation<a hidden class=anchor aria-hidden=true href=#custom-data-tranformation>#</a></h3><ul><li>Custom Data Transformation 在資料讀取和建立表格之間添加了一層，提供在匯入資料前修改資料的方法。資料轉換將一個規則或函數應用於檢索到的資料，以準備進行分析。</li></ul><h3 id=custom-data-writer>Custom Data Writer<a hidden class=anchor aria-hidden=true href=#custom-data-writer>#</a></h3><ul><li>Custom Data Writer 用於匯出自定義格式的檔案。</li></ul><h3 id=custom-expression-functions>Custom Expression Functions<a hidden class=anchor aria-hidden=true href=#custom-expression-functions>#</a></h3><ul><li>Custom Expression Functions 可以擴展在自定義表達式和計算列中使用的表達式語言。可以是基於行、列或聚合方法。</li></ul><h3 id=custom-fitting-model>Custom Fitting Model<a hidden class=anchor aria-hidden=true href=#custom-fitting-model>#</a></h3><ul><li>Custom Fitting Model 由 Visualization 的座標和參數計算出值，以繪值對應的參考點或曲線。</li></ul><h3 id=custom-virtual-column>Custom Virtual Column<a hidden class=anchor aria-hidden=true href=#custom-virtual-column>#</a></h3><ul><li>Custom Virtual Column 根據一個或多個現有的列和文件屬性創建新的欄。</li></ul><h3 id=custom-preference>Custom Preference<a hidden class=anchor aria-hidden=true href=#custom-preference>#</a></h3><ul><li>Custom Preference 偏好設定，也稱作 Configuration Sets。</li></ul><h3 id=custom-license>Custom License<a hidden class=anchor aria-hidden=true href=#custom-license>#</a></h3><ul><li>Custom License 可用於自訂授權。</li></ul><h3 id=custom-node>Custom Node<a hidden class=anchor aria-hidden=true href=#custom-node>#</a></h3><ul><li>Custom Node 可以添加項目到 spotfire document model 中，並序列化到 dxp 文件中。</li></ul><h3 id=custom-application-event-handler>Custom Application Event Handler<a hidden class=anchor aria-hidden=true href=#custom-application-event-handler>#</a></h3><ul><li>Custom Application Event Handler 可用來監控並回應應用程式事件。</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://intervalrain.github.io/tags/spotfire/>Spotfire</a></li><li><a href=https://intervalrain.github.io/tags/dxp/>Dxp</a></li></ul><script type=module>  
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs'; 
    mermaid.initialize({ startOnLoad: true });  
</script><script>Array.from(document.getElementsByClassName("language-mermaid")).forEach(e=>{e.parentElement.outerHTML=`<div class="mermaid">${e.innerHTML}</div>`})</script><style>.mermaid svg{display:block;margin:auto}</style></footer><script src=https://utteranc.es/client.js repo=Reid00/hugo-blog-talks issue-term=pathname label=Comment theme=github-light crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2025 <a href=https://intervalrain.github.io/>Rain Hu's Workspace</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="複製";function s(){t.innerHTML="已複製！",setTimeout(()=>{t.innerHTML="複製"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>